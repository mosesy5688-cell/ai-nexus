---
/**
 * Zone 2: Quick Insights
 * Displays key decision metrics (Params, Context, Downloads, etc.)
 * Adapts to 6 entity types via `inference.js`
 */
import { getQuickInsights } from '../../utils/inference.js';

export interface Props {
  entity: any;
  type: 'model' | 'agent' | 'space' | 'tool' | 'dataset' | 'paper';
}

const { entity, type } = Astro.props;
const insights = getQuickInsights(entity, type) || [];
---

<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-8">
  {insights.length > 0 ? insights.map((item) => (
    <div class={`
      relative flex flex-col items-center justify-center p-4 rounded-xl border transition-all duration-300
      ${item.highlight 
        ? 'bg-indigo-50/50 dark:bg-indigo-900/10 border-indigo-200 dark:border-indigo-800 ring-1 ring-indigo-500/10 shadow-sm' 
        : 'bg-white/80 dark:bg-gray-800/80 border-gray-100 dark:border-gray-700 shadow-sm hover:shadow-md hover:border-gray-200 dark:hover:border-gray-600'}
      backdrop-blur-sm group overflow-hidden
    `}>
      {/* V15.15: Dynamic Badge Rendering */}
      {item.badge && (
        <span class="absolute top-0 right-0 px-2 py-0.5 bg-indigo-100 dark:bg-indigo-900/60 text-[9px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-tighter rounded-bl-lg border-l border-b border-indigo-200/30 dark:border-indigo-800/30">
          {item.badge}
        </span>
      )}

      <span class="text-xl font-bold text-gray-900 dark:text-white mb-1 font-mono tracking-tight">
        {item.value}
      </span>
      <span class="text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest text-center">
        {item.label}
      </span>
      
      {item.highlight && !item.badge && (
        <div class="absolute -top-1 -right-1 flex h-3 w-3">
          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span>
          <span class="relative inline-flex rounded-full h-3 w-3 bg-indigo-500"></span>
        </div>
      )}
    </div>
  )) : (
    <div class="col-span-full py-4 text-center text-gray-400 italic text-sm border border-dashed border-gray-200 dark:border-gray-800 rounded-lg">
      Insufficient metadata for insights display
    </div>
  )}

  {/* Quick Action: Scroll to Deep Dive */}
  {insights.length > 0 && (
    <div class="hidden md:flex col-span-1 items-center justify-center">
      <button 
        class="group text-xs font-bold text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-colors"
        onclick="document.getElementById('deep-dive-section')?.scrollIntoView({behavior: 'smooth'})"
      >
        <span class="p-1.5 bg-indigo-100 dark:bg-indigo-900/40 rounded-md group-hover:scale-110 transition-transform">ðŸ”¬</span>
        <span>Dive Deep</span>
      </button>
    </div>
  )}
</div>
