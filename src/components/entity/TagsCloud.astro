---
/**
 * TagsCloud.astro - V15.2
 * Zone 4: Deep Dive - Display entity tags in a visually appealing cloud
 */

interface Props {
  tags: string[];
  type?: 'model' | 'agent' | 'space' | 'tool' | 'dataset' | 'paper';
}

const { tags = [], type = 'model' } = Astro.props;

// Filter and clean tags
const cleanTags = tags
  .filter(t => t && typeof t === 'string' && t.trim().length > 0)
  .map(t => t.trim())
  .slice(0, 20); // Limit to 20 tags

const hasTags = cleanTags.length > 0;

// Color palette based on entity type
const colorMap = {
  model: { bg: 'bg-indigo-100 dark:bg-indigo-900/30', text: 'text-indigo-700 dark:text-indigo-300', border: 'border-indigo-200 dark:border-indigo-800' },
  agent: { bg: 'bg-emerald-100 dark:bg-emerald-900/30', text: 'text-emerald-700 dark:text-emerald-300', border: 'border-emerald-200 dark:border-emerald-800' },
  space: { bg: 'bg-blue-100 dark:bg-blue-900/30', text: 'text-blue-700 dark:text-blue-300', border: 'border-blue-200 dark:border-blue-800' },
  tool: { bg: 'bg-purple-100 dark:bg-purple-900/30', text: 'text-purple-700 dark:text-purple-300', border: 'border-purple-200 dark:border-purple-800' },
  dataset: { bg: 'bg-amber-100 dark:bg-amber-900/30', text: 'text-amber-700 dark:text-amber-300', border: 'border-amber-200 dark:border-amber-800' },
  paper: { bg: 'bg-rose-100 dark:bg-rose-900/30', text: 'text-rose-700 dark:text-rose-300', border: 'border-rose-200 dark:border-rose-800' },
};

const colors = colorMap[type] || colorMap.model;
---

{hasTags && (
  <section class="tags-cloud p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700">
    <h3 class="text-sm font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-2">
      <span>üè∑Ô∏è</span> Tags
    </h3>
    
    <div class="flex flex-wrap gap-2">
      {cleanTags.map((tag) => (
        <a 
          href={`/explore?tag=${encodeURIComponent(tag)}`}
          class={`
            inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium
            ${colors.bg} ${colors.text} ${colors.border} border
            hover:shadow-md hover:scale-105 transition-all duration-200
          `}
        >
          {tag}
        </a>
      ))}
    </div>
    
    {tags.length > 20 && (
      <p class="text-xs text-gray-400 mt-3">
        +{tags.length - 20} more tags
      </p>
    )}
  </section>
)}
