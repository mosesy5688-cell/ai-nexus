---
// src/components/ModelInfoTable.astro
// SEO-optimized information table for Google Featured Snippets
// V16.5: Refactored for Constitutional Compliance (Art 5.1 - 250 line limit)

const { model, type = 'model' } = Astro.props;

// V6.3: Derive display values with fallbacks
const displayName = model.displayName || model.name || model.canonical_name || 'Unknown Entity';
const source = model.source || (model.slug?.startsWith('huggingface') || model.id?.startsWith('huggingface') ? 'Hugging Face' : model.slug?.startsWith('ollama') || model.id?.startsWith('ollama') ? 'Ollama' : 'Unknown');

// V16.7: Type-aware labels
const typeLabel = type === 'agent' || type === 'tool' ? 'Runtime' : (type === 'dataset' ? 'Format' : 'Primary Category');
const captionLabel = type.charAt(0).toUpperCase() + type.slice(1);
---

<div class="mb-6 overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700">
  <table class="w-full text-sm" itemscope itemtype="http://schema.org/Table">
    <caption class="sr-only">{captionLabel} Information Summary</caption>
    <tbody class="divide-y divide-gray-200 dark:border-gray-700">
      <tr class="bg-zinc-50/50 dark:bg-zinc-900/50">
        <td colspan="2" class="px-4 py-2 text-[10px] font-black text-zinc-500 uppercase tracking-[0.2em]">Entity Passport</td>
      </tr>
      <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors">
        <td class="px-4 py-3 font-semibold text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-900/50 w-1/3">Registry ID</td>
        <td class="px-4 py-3 text-xs font-mono text-zinc-500 truncate" itemprop="name">{model.id || model.slug || 'Unknown'}</td>
      </tr>
      {model.license && (
        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors">
          <td class="px-4 py-3 font-semibold text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-900/50">License</td>
          <td class="px-4 py-3 text-gray-700 dark:text-gray-300" itemprop="license">{model.license}</td>
        </tr>
      )}
      {model.library_name && (
        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors">
          <td class="px-4 py-3 font-semibold text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-900/50">Library</td>
          <td class="px-4 py-3 text-gray-700 dark:text-gray-300" itemprop="softwareRequirements">{model.library_name}</td>
        </tr>
      )}
      <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors">
        <td class="px-4 py-3 font-semibold text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-900/50">Provider</td>
        <td class="px-4 py-3 text-gray-700 dark:text-gray-300 capitalize">{source}</td>
      </tr>
    </tbody>
  </table>
</div>

<style>
  /* Ensure table is mobile-friendly */
  @media (max-width: 640px) {
    td {
      display: block;
      width: 100%;
    }
    td:first-child {
      border-bottom: none;
      padding-bottom: 0.5rem;
    }
    td:last-child {
      padding-top: 0.5rem;
    }
  }
</style>
