---
// src/components/StarRating.astro
interface Props {
  likes: number;
}

const { likes } = Astro.props;

// Simple logic to convert likes to a 0-5 star rating
let rating = 0;
if (likes > 10000) rating = 5;
else if (likes > 5000) rating = 4.5;
else if (likes > 2500) rating = 4;
else if (likes > 1000) rating = 3.5;
else if (likes > 500) rating = 3;
else if (likes > 100) rating = 2.5;
else rating = 2;

const percentage = (rating / 5) * 100;
---
<div class="flex items-center" title={`Rating: ${rating} out of 5 stars`}>
  <div class="stars" style={`--rating: ${rating};`}>★★★★★</div>
  <span class="ml-2 text-xs text-gray-500 dark:text-gray-400">({likes.toLocaleString()} likes)</span>
</div>

<style>
  .stars {
    --star-background: #d1d5db; /* gray-300 */
    --star-color: #f59e0b; /* amber-500 */
    --percent: calc(var(--rating) / 5 * 100%);
    
    display: inline-block;
    font-size: 1.25rem;
    font-family: Times; /* Make sure stars are rendered correctly */
    line-height: 1;
    
    &::before {
      content: '★★★★★';
      letter-spacing: 3px;
      background: linear-gradient(90deg, var(--star-color) var(--percent), var(--star-background) var(--percent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
  }
  .dark .stars {
    --star-background: #4b5563; /* gray-600 */
  }
</style>