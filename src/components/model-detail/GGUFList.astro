---
/**
 * GGUFList Component - Zone 4
 * V15.0: Display GGUF quantization variants for download
 */
interface GGUFVariant {
  name: string;
  size?: string;
  quantType?: string;
  url?: string;
}

interface Props {
  variants: GGUFVariant[];
  hasGguf?: boolean;
  modelId?: string;
  defaultExpanded?: boolean;
}

const { variants = [], hasGguf, modelId, defaultExpanded = true } = Astro.props;

const displayVariants = variants.slice(0, 10);
const hasVariants = displayVariants.length > 0 || hasGguf;

function getQuantBadgeColor(quant: string): string {
  if (quant?.includes('Q8') || quant?.includes('F16')) return 'bg-green-100 text-green-700';
  if (quant?.includes('Q6') || quant?.includes('Q5')) return 'bg-blue-100 text-blue-700';
  if (quant?.includes('Q4')) return 'bg-yellow-100 text-yellow-700';
  if (quant?.includes('Q3') || quant?.includes('Q2')) return 'bg-orange-100 text-orange-700';
  return 'bg-gray-100 text-gray-700';
}
---

{hasVariants && (
  <section class="gguf-list bg-white dark:bg-gray-800 rounded-xl shadow-sm mb-6">
    <details open={defaultExpanded}>
      <summary class="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-t-xl">
        <h3 class="text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2">
          <span>ðŸ“¦</span> GGUF Downloads
        </h3>
        <span class="px-2 py-1 text-xs bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300 rounded-full">
          {variants.length || 'Available'}
        </span>
      </summary>
      
      <div class="p-4 pt-0 border-t border-gray-100 dark:border-gray-700">
        {displayVariants.length > 0 ? (
          <div class="space-y-2">
            {displayVariants.map(v => (
              <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/30 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                <div class="flex items-center gap-3">
                  <span class="text-lg">ðŸ“„</span>
                  <div>
                    <div class="font-medium text-gray-900 dark:text-white text-sm">{v.name}</div>
                    {v.size && <div class="text-xs text-gray-500">{v.size}</div>}
                  </div>
                </div>
                <div class="flex items-center gap-2">
                  {v.quantType && (
                    <span class={`px-2 py-0.5 text-xs rounded ${getQuantBadgeColor(v.quantType)} dark:bg-opacity-20`}>
                      {v.quantType}
                    </span>
                  )}
                  {v.url && (
                    <a href={v.url} target="_blank" rel="noopener noreferrer"
                       class="px-3 py-1 text-xs bg-indigo-600 text-white rounded hover:bg-indigo-700">
                      Download
                    </a>
                  )}
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div class="text-center py-4 text-gray-500 dark:text-gray-400">
            <p class="text-sm">GGUF variants available on HuggingFace</p>
            {modelId && (
              <a href={`https://huggingface.co/${modelId.replace('--', '/')}/tree/main`} 
                 target="_blank" rel="noopener noreferrer"
                 class="inline-block mt-2 px-4 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                View on HuggingFace
              </a>
            )}
          </div>
        )}
      </div>
    </details>
  </section>
)}

<style>
  details summary::-webkit-details-marker { display: none; }
</style>
