---
// src/components/compare/ScoreComparison.astro
interface Props {
  compareModels: any[];
  radarMetrics: string[];
}

const { compareModels, radarMetrics } = Astro.props;
---

<section class="compare-section">
  <h2 class="section-title">ðŸ“Š Score Comparison</h2>
  <div class="comparison-table-wrapper">
    <table class="comparison-table">
      <thead>
        <tr>
          <th>Metric</th>
          {compareModels.map(m => (
            <th>{m.name.split('/').pop()}</th>
          ))}
        </tr>
      </thead>
      <tbody>
        {radarMetrics.map(metric => {
          const scores = compareModels.map(m => m.benchmark?.[metric] || 0);
          const maxScore = Math.max(...scores);
          return (
            <tr>
              <td class="metric-name">{metric.toUpperCase().replace('_', ' ')}</td>
              {compareModels.map(m => {
                const score = m.benchmark?.[metric] || 0;
                const isWinner = score === maxScore && score > 0;
                return (
                  <td class={isWinner ? 'winner' : ''}>
                    {score || '-'}
                    {isWinner && <span class="crown">ðŸ‘‘</span>}
                  </td>
                );
              })}
            </tr>
          );
        })}
        <tr class="avg-row">
          <td class="metric-name">AVERAGE</td>
          {compareModels.map(m => {
            const scores = compareModels.map(x => x.benchmark?.avg_score || 0);
            const maxAvg = Math.max(...scores);
            const score = m.benchmark?.avg_score || 0;
            const isWinner = score === maxAvg && score > 0;
            return (
              <td class={`avg ${isWinner ? 'winner' : ''}`}>
                <strong>{score?.toFixed(1) || '-'}</strong>
                {isWinner && <span class="crown">ðŸ‘‘</span>}
              </td>
            );
          })}
        </tr>
      </tbody>
    </table>
  </div>
</section>
