---
export const prerender = false;
const db = Astro.locals.runtime?.env?.DB;
let message = "Initializing...";
let count = 0;

if (db) {
    try {
        const { results } = await db.prepare("SELECT COUNT(*) as c FROM models").all();
        count = results[0].c;
        message = "D1 Connected Successfully";
    } catch(e) {
        message = `D1 Error: ${e.message}`;
        count = -1;
    }
} else {
    message = "D1 Binding NOT Found";
}
---
<html>
<body>
    <h1>D1 Debug Page</h1>
    <p>Status: {message}</p>
    <p>Model count: {count}</p>
</body>
</html>
