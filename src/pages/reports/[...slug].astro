---
import Layout from '@/layouts/Layout.astro';
import { Markdown } from '@astrojs/markdown-component';
import allReports from '@/data/reports.json';
import allModels from '@/data/models.json';

export function getStaticPaths() {
    return allReports.map(report => ({
        params: { slug: report.reportId },
        props: { report },
    }));
}

const { report } = Astro.props;

const featuredModels = report.featuredModelIds
    ? report.featuredModelIds.map(id => allModels.find(m => m.id === id)).filter(Boolean)
    : [];
---

<Layout title={report.title} description={report.summary}>
    <main class="container mx-auto px-4 py-12">
        <article class="max-w-4xl mx-auto">
            <header class="mb-8 text-center">
                <h1 class="text-4xl font-extrabold text-gray-900 dark:text-white">{report.title}</h1>
                <p class="mt-2 text-lg text-gray-500 dark:text-gray-400">
                    {new Date(report.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC' })}
                </p>
            </header>

            <div class="prose prose-lg dark:prose-invert max-w-none mx-auto">
                {report.sections.map(section => (
                    <section class="mb-12">
                        <h2 class="text-2xl font-bold border-b border-gray-300 dark:border-gray-700 pb-2 mb-4">{section.heading}</h2>
                        <div class="prose prose-lg dark:prose-invert max-w-none mx-auto"><Markdown content={section.content} /></div>
                    </section>
                ))}
            </div>
        </article>
    </main>
</Layout>
