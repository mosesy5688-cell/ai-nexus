---
export const prerender = false;

/**
 * ArXiv Short Path Redirect (V15.13)
 * 
 * Redirects /paper/{arxivId} to canonical /paper/arxiv/{arxivId}
 * This ensures URL normalization and avoids duplicate content for SEO.
 * 
 * Constitutional Reference: Art.III URL Stability Law
 */

const { arxivId } = Astro.params;

// Validate ArXiv ID format (supports optional version suffix like v1, v2)
const isValidArxivId = arxivId && /^\d{4}\.\d{4,5}(v\d+)?$/.test(arxivId);

if (isValidArxivId) {
  // V15.13: Permanent redirect to canonical URL format
  return Astro.redirect(`/paper/arxiv/${arxivId}`, 301);
}

// Invalid ArXiv ID - show error page
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Invalid Paper ID - Free AI Tools" description="Invalid ArXiv paper ID format">
  <div class="container mx-auto px-4 py-24 text-center">
    <div class="max-w-4xl mx-auto">
      <h1 class="text-8xl font-black text-gray-100 dark:text-gray-800 absolute left-1/2 -translate-x-1/2 -top-4 -z-10 select-none">400</h1>
      <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-6">Invalid Paper ID</h2>
      <p class="text-lg text-gray-600 dark:text-gray-400 mb-10 max-w-md mx-auto">
        The ArXiv ID format should be like: <code class="px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded font-mono text-indigo-600">2407.21783</code>
      </p>
      
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="/" class="inline-flex items-center justify-center px-8 py-3 text-base font-bold text-white bg-indigo-600 rounded-xl shadow-lg hover:bg-indigo-700 transition-all hover:scale-105 active:scale-95">
          Go Home
        </a>
        <a href={`/search?q=${encodeURIComponent(arxivId || '')}`} class="inline-flex items-center justify-center px-8 py-3 text-base font-bold text-gray-700 bg-white border-2 border-gray-100 rounded-xl shadow-sm hover:border-indigo-100 hover:bg-indigo-50/30 transition-all dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-700">
          Search for "{arxivId}"
        </a>
      </div>
    </div>
  </div>
</Layout>
