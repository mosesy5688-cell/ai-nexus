<!DOCTYPE html><html lang="en"> <head><!-- Google Tag Manager --><script type="module">(function(e,n,r,t,m){e[t]=e[t]||[],e[t].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s="";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-58C2CQ8G");</script><!-- End Google Tag Manager --><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><!-- Open Graph Meta Tags --><meta property="og:type" content="website"><meta property="og:url" content="https://free2aitools.com/model/bavest--fin-llama-33b-merged/"><meta property="og:title" content="fin-llama-33b-merged - AI Model Details"><meta property="og:description" content="A model for text-generation."><meta property="og:image" content="https://free2aitools.com/og-image.jpg"><!-- Twitter Card Meta Tags --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://free2aitools.com/model/bavest--fin-llama-33b-merged/"><meta property="twitter:title" content="fin-llama-33b-merged - AI Model Details"><meta property="twitter:description" content="A model for text-generation."><meta property="twitter:image" content="https://free2aitools.com/og-image.jpg"><meta name="description" content="A model for text-generation."><title>fin-llama-33b-merged - AI Model Details</title><link rel="canonical" href="https://free2aitools.com/model/bavest--fin-llama-33b-merged/"><!-- Google AdSense --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2292826803755214" crossorigin="anonymous"></script><link rel="stylesheet" href="/_astro/about.CAZw8hUu.css"></head> <body class="bg-gray-50 text-gray-800 font-sans antialiased flex flex-col min-h-screen"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58C2CQ8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <header class="sticky top-0 z-30 w-full backdrop-blur flex-none transition-colors duration-500 lg:border-b lg:border-gray-200 bg-white/80"> <nav class="container mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex items-center justify-between h-16"> <!-- Site Logo --> <a href="/" class="flex items-center gap-2 text-xl sm:text-2xl font-bold text-gray-900"> <span>Free AI Tools</span> </a> <!-- Right-side items --> <div class="flex items-center gap-4"> <!-- Desktop Navigation --> <div class="hidden md:flex items-center gap-6"> <a href="/" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Explore Models </a><a href="/ranking" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Rankings </a><a href="/reports" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Reports </a><a href="/about" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> About </a> </div> <!-- Mobile Search & Menu Toggle --> <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-default" aria-expanded="false"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path></svg> </button> </div> </div> <!-- Mobile Collapsible Menu --> <div class="hidden w-full md:hidden" id="navbar-default"> <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50"> <li> <a href="/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Explore Models</a> </li><li> <a href="/ranking" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Rankings</a> </li><li> <a href="/reports" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Reports</a> </li><li> <a href="/about" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">About</a> </li> </ul> </div> </nav> </header> <main class="flex-grow">  <div class="container mx-auto px-4 py-12"> <div class="max-w-4xl mx-auto"> <!-- Header Section --> <header class="mb-8"> <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4"> <div> <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-2">fin-llama-33b-merged</h1> <p class="text-lg text-gray-500 dark:text-gray-400">by </p> </div>  </div> </header> <!-- Metadata Section --> <div class="mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg"> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Likes</p> <p class="text-xl font-bold">210</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Downloads</p> <p class="text-xl font-bold">9,060</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Task</p> <p class="text-xl font-bold capitalize">text-generation</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Last Updated</p> <p class="text-xl font-bold">Invalid Date</p> </div> </div> </div> <h3 class="text-lg font-semibold mb-2">Sources</h3> <div class="flex flex-col gap-2"> <a href="https://huggingface.co/bavest/fin-llama-33b-merged" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/bavest/fin-llama-33b-merged" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/bavest/fin-llama-33b-merged" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/bavest/fin-llama-33b-merged" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/bavest/fin-llama-33b-merged" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a> </div> </div> </div>  <div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div> <article class="model-readme-content py-8 border-t border-gray-200 dark:border-gray-700"> <div class="prose prose-lg dark:prose-invert max-w-none"> <h1>FIN-LLAMA</h1>
<blockquote>
<p>Efficient Finetuning of Quantized LLMs for Finance</p>
</blockquote>
<p><a href="https://huggingface.co/bavest/fin-llama-33b-merged">Adapter Weights</a>
|  <a href="https://huggingface.co/datasets/bavest/fin-llama-dataset">Dataset</a></p>
<h2>Installation</h2>
<p>To load models in 4bits with transformers and bitsandbytes, you have to install accelerate and transformers from source
and make sure you have the latest version of the bitsandbytes library (0.39.0).</p>
<pre><code class="language-bash">pip3 install -r requirements.txt
</code></pre>
<h3>Other dependencies</h3>
<p>If you want to finetune the model on a new instance. You could run
the <code>setup.sh</code> to install the python and cuda package.</p>
<pre><code class="language-bash">bash scripts/setup.sh
</code></pre>
<h2>Finetuning</h2>
<pre><code class="language-bash">bash script/finetune.sh
</code></pre>
<h2>Usage</h2>
<p>Quantization parameters are controlled from the <code>BitsandbytesConfig</code></p>
<ul>
<li>Loading in 4 bits is activated through <code>load_in_4bit</code></li>
<li>The datatype used for the linear layer computations with <code>bnb_4bit_compute_dtype</code></li>
<li>Nested quantization is activated through <code>bnb_4bit_use_double_quant</code></li>
<li>The datatype used for qunatization is specified with <code>bnb_4bit_quant_type</code>. Note that there are two supported
quantization datatypes <code>fp4</code> (four bit float) and <code>nf4</code> (normal four bit float). The latter is theoretically optimal
for normally distributed weights and we recommend using <code>nf4</code>.</li>
</ul>
<pre><code class="language-python">import torch
from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig

pretrained_model_name_or_path = &quot;bavest/fin-llama-33b-merge&quot;
model = AutoModelForCausalLM.from_pretrained(
    pretrained_model_name_or_path=pretrained_model_name_or_path,
    load_in_4bit=True,
    device_map=&#39;auto&#39;,
    torch_dtype=torch.bfloat16,
    quantization_config=BitsAndBytesConfig(
        load_in_4bit=True,
        bnb_4bit_compute_dtype=torch.bfloat16,
        bnb_4bit_use_double_quant=True,
        bnb_4bit_quant_type=&#39;nf4&#39;
    ),
)

tokenizer = AutoTokenizer.from_pretrained(pretrained_model_name_or_path)

question = &quot;What is the market cap of apple?&quot;
input = &quot;&quot; # context if needed

prompt = f&quot;&quot;&quot;
A chat between a curious human and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user&#39;s question.
&#39;### Instruction:\n{question}\n\n### Input:{input}\n&quot;&quot;\n\n### Response: 
&quot;&quot;&quot;

input_ids = tokenizer.encode(prompt, return_tensors=&quot;pt&quot;).to(&#39;cuda:0&#39;)

with torch.no_grad():
    generated_ids = model.generate(
        input_ids,
        do_sample=True,
        top_p=0.9,
        temperature=0.8,
        max_length=128
    )

generated_text = tokenizer.decode(
    [el.item() for el in generated_ids[0]], skip_special_tokens=True
)
</code></pre>
<h2>Dataset for FIN-LLAMA</h2>
<p>The dataset is released under bigscience-openrail-m.
You can find the dataset used to train FIN-LLAMA models on HF
at <a href="https://huggingface.co/datasets/bavest/fin-llama-dataset">bavest/fin-llama-dataset</a>.</p>
<h2>Known Issues and Limitations</h2>
<p>Here a list of known issues and bugs. If your issue is not reported here, please open a new issue and describe the
problem.
See <a href="https://github.com/artidoro/qlora">QLORA</a> for any other limitations.</p>
<ol>
<li>4-bit inference is slow. Currently, our 4-bit inference implementation is not yet integrated with the 4-bit matrix
multiplication</li>
<li>Currently, using <code>bnb_4bit_compute_type=&#39;fp16&#39;</code> can lead to instabilities.</li>
<li>Make sure that <code>tokenizer.bos_token_id = 1</code> to avoid generation issues.</li>
</ol>
<h2>Acknowledgements</h2>
<p>We also thank Meta for releasing the LLaMA models without which this work would not have been possible.</p>
<p>This repo builds on the <a href="https://github.com/tatsu-lab/stanford_alpaca">Stanford Alpaca</a>
, <a href="https://github.com/artidoro/qlora">QLORA</a>, <a href="https://github.com/jianzhnie/Chinese-Guanaco/tree/main">Chinese-Guanaco</a>
and <a href="https://github.com/lm-sys/FastChat">LMSYS FastChat</a> repos.</p>
<h2>License and Intended Use</h2>
<p>We release the resources associated with QLoRA finetuning in this repository under GLP3 license. In addition, we release the FIN-LLAMA model family for base LLaMA model sizes of 7B, 13B, 33B, and 65B. These models are intended for purposes in line with the LLaMA license and require access to the LLaMA models.</p>
<h2>Prompts</h2>
<h3>Act as an Accountant</h3>
<blockquote>
<p>I want you to act as an accountant and come up with creative ways to manage finances. You&#39;ll need to consider budgeting, investment strategies and risk management when creating a financial plan for your client. In some cases, you may also need to provide advice on taxation laws and regulations in order to help them maximize their profits. My first suggestion request is ‚ÄúCreate a financial plan for a small business that focuses on cost savings and long-term investments&quot;.</p>
</blockquote>
<h2>Paged Optimizer</h2>
<p>You can access the paged optimizer with the argument --optim paged_adamw_32bit</p>
<h2>Cite</h2>
<pre><code class="language-tex">@misc{Fin-LLAMA,
  author = {William Todt, Ramtin Babaei, Pedram Babaei},
  title = {Fin-LLAMA: Efficient Finetuning of Quantized LLMs for Finance},
  year = {2023},
  publisher = {GitHub},
  journal = {GitHub repository},
  howpublished = {\url{https://github.com/Bavest/fin-llama}},
}
</code></pre>
<h1><a href="https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard">Open LLM Leaderboard Evaluation Results</a></h1>
<p>Detailed results can be found <a href="https://huggingface.co/datasets/open-llm-leaderboard/details_bavest__fin-llama-33b-merged">here</a></p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>Avg.</td>
<td>51.76</td>
</tr>
<tr>
<td>ARC (25-shot)</td>
<td>65.02</td>
</tr>
<tr>
<td>HellaSwag (10-shot)</td>
<td>86.2</td>
</tr>
<tr>
<td>MMLU (5-shot)</td>
<td>58.73</td>
</tr>
<tr>
<td>TruthfulQA (0-shot)</td>
<td>49.75</td>
</tr>
<tr>
<td>Winogrande (5-shot)</td>
<td>80.03</td>
</tr>
<tr>
<td>GSM8K (5-shot)</td>
<td>16.22</td>
</tr>
<tr>
<td>DROP (3-shot)</td>
<td>6.36</td>
</tr>
</tbody></table>
 </div> </article>  <section class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"> <h2 class="text-3xl font-bold text-center mb-8">Related Models</h2> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"> <a href="/model/TheBloke--fin-llama-33B-GPTQ" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="fin-llama-33B-GPTQ"> fin-llama-33B-GPTQ </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="70 likes">‚ù§Ô∏è <span>70</span></div> <div class="flex items-center gap-1" title="330 downloads">üì• <span>330</span></div> </div> </div> </a><a href="/model/McGill-NLP--Llama-3-8B-Web" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="Llama-3-8B-Web"> Llama-3-8B-Web </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="2,140 likes">‚ù§Ô∏è <span>2.1K</span></div> <div class="flex items-center gap-1" title="460 downloads">üì• <span>460</span></div> </div> </div> </a><a href="/model/LLM360--Amber" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="Amber"> Amber </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="710 likes">‚ù§Ô∏è <span>710</span></div> <div class="flex items-center gap-1" title="19,230 downloads">üì• <span>19.2K</span></div> </div> </div> </a> </div> </section> </main> <footer class="bg-gray-800 text-gray-300 py-8 mt-16"> <div class="container mx-auto px-4 text-center"> <div class="flex justify-center gap-4 mb-4"> <a href="/about" class="hover:underline">About</a> <a href="/compliance" class="hover:underline">Compliance</a> </div> <p class="text-sm mt-2">
&copy; 2025 Free AI Tools. An open-source project to index the world of AI.
</p> <a href="mailto:compliance@free2aitools.com" class="text-sm text-gray-400 hover:underline mt-1 block">compliance@free2aitools.com</a> </div> </footer> </body></html>