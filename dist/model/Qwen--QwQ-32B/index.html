<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="A model for text-generation."><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.15.3"><title>QwQ-32B</title><link rel="stylesheet" href="/_astro/about.BWOaSv6e.css"></head> <body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex flex-col min-h-screen"> <header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50"> <nav class="container mx-auto px-4 py-4 flex justify-between items-center"> <a href="/" class="text-2xl font-bold text-gray-900 dark:text-white shrink-0">Free AI Tools</a> <div class="w-full max-w-md mx-4"> <input type="search" id="header-search" placeholder="Search models..." class="w-full px-4 py-2 text-base bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors"> </div> <div class="space-x-4 shrink-0"> <a href="/explore" class="text-gray-600 dark:text-gray-300 hover:text-blue-500">Explore</a> <a href="/about" class="text-gray-600 dark:text-gray-300 hover:text-blue-500">About</a> </div> </nav> </header> <main class="flex-grow">  <div class="container mx-auto px-4 py-12"> <a href="javascript:history.back()" class="text-blue-500 hover:underline mb-8 block font-medium transition-colors">&larr; Back to previous page</a> <article class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-xl"> <header class="border-b pb-4 mb-6"> <h1 class="text-4xl font-extrabold text-gray-900 dark:text-white leading-tight">QwQ-32B</h1>  </header> <div class="grid grid-cols-1 lg:grid-cols-4 gap-12 relative"> <div class="lg:col-span-3"> <section class="mb-8"> <h3 class="text-lg font-semibold mb-2 text-gray-800 dark:text-gray-200">Tags</h3> <div id="tags-container" class="flex flex-wrap gap-2"> <span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">transformers</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">safetensors</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">qwen2</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">text-generation</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">chat</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">conversational</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">en</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">arxiv:2309.00071</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">arxiv:2412.15115</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">base_model:Qwen/Qwen2.5-32B</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">base_model:finetune:Qwen/Qwen2.5-32B</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">license:apache-2.0</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">autotrain_compatible</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">text-generation-inference</span><span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">endpoints_compatible</span> <button id="show-all-tags" class="bg-gray-200 text-gray-700 text-sm font-medium px-3 py-1 rounded-full dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
Show all (16)
</button> </div> </section> <section id="details-usage" class="mt-8 mb-10"> <h2 class="text-3xl font-bold mb-4 text-gray-800 dark:text-gray-200 border-b pb-2">Details & Usage</h2> <div class="prose dark:prose-invert prose-lg max-w-none bg-gray-50 dark:bg-gray-900 p-6 rounded-lg prose-pre:bg-gray-200 dark:prose-pre:bg-gray-800 prose-pre:text-gray-800 dark:prose-pre:text-gray-200 border border-gray-100 dark:border-gray-700 shadow-inner"> <div>---
license: apache-2.0
license_link: https://huggingface.co/Qwen/QWQ-32B/blob/main/LICENSE
language:
- en
pipeline_tag: text-generation
base_model: Qwen/Qwen2.5-32B
tags:
- chat
library_name: transformers
---

# QwQ-32B

<a href="https://chat.qwenlm.ai/" target="_blank" style="margin: 2px;">
    <img alt="Chat" src="https://img.shields.io/badge/%F0%9F%92%9C%EF%B8%8F%20Qwen%20Chat%20-536af5" style="display: inline-block; vertical-align: middle;"/>
</a>

## Introduction

QwQ is the reasoning model of the Qwen series. Compared with conventional instruction-tuned models, QwQ, which is capable of thinking and reasoning, can achieve significantly enhanced performance in downstream tasks, especially hard problems. QwQ-32B is the medium-sized reasoning model, which is capable of achieving competitive performance against state-of-the-art reasoning models, e.g., DeepSeek-R1, o1-mini.

<p align="center">
  <img width="100%" src="figures/benchmark.jpg">
</p>


**This repo contains the QwQ 32B model**, which has the following features:
- Type: Causal Language Models
- Training Stage: Pretraining & Post-training (Supervised Finetuning and Reinforcement Learning)
- Architecture: transformers with RoPE, SwiGLU, RMSNorm, and Attention QKV bias
- Number of Parameters: 32.5B
- Number of Paramaters (Non-Embedding): 31.0B
- Number of Layers: 64
- Number of Attention Heads (GQA): 40 for Q and 8 for KV
- Context Length: Full 131,072 tokens
    - For prompts exceeding 8,192 tokens in length, you must enable YaRN as outlined in [this section](#usage-guidelines).

**Note:** For the best experience, please review the [usage guidelines](#usage-guidelines) before deploying QwQ models.

You can try our [demo](https://huggingface.co/spaces/Qwen/QwQ-32B-Demo) or access QwQ models via [QwenChat](https://chat.qwen.ai).

For more details, please refer to our [blog](https://qwenlm.github.io/blog/qwq-32b/), [GitHub](https://github.com/QwenLM/Qwen2.5), and [Documentation](https://qwen.readthedocs.io/en/latest/).

## Requirements

QwQ is based on Qwen2.5, whose code has been in the latest Hugging face `transformers`. We advise you to use the latest version of `transformers`.

With `transformers<4.37.0`, you will encounter the following error:
```
KeyError: 'qwen2'
```

## Quickstart

Here provides a code snippet with `apply_chat_template` to show you how to load the tokenizer and model and how to generate contents.

```python
from transformers import AutoModelForCausalLM, AutoTokenizer

model_name = "Qwen/QwQ-32B"

model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype="auto",
    device_map="auto"
)
tokenizer = AutoTokenizer.from_pretrained(model_name)

prompt = "How many r's are in the word \"strawberry\""
messages = [
    {"role": "user", "content": prompt}
]
text = tokenizer.apply_chat_template(
    messages,
    tokenize=False,
    add_generation_prompt=True
)

model_inputs = tokenizer([text], return_tensors="pt").to(model.device)

generated_ids = model.generate(
    **model_inputs,
    max_new_tokens=32768
)
generated_ids = [
    output_ids[len(input_ids):] for input_ids, output_ids in zip(model_inputs.input_ids, generated_ids)
]

response = tokenizer.batch_decode(generated_ids, skip_special_tokens=True)[0]
print(response)
```

### Usage Guidelines

To achieve optimal performance, we recommend the following settings:

1. **Enforce Thoughtful Output**: Ensure the model starts with "\<think\>\n" to prevent generating empty thinking content, which can degrade output quality. If you use `apply_chat_template` and set `add_generation_prompt=True`, this is already automatically implemented, but it may cause the response to lack the \<think\> tag at the beginning. This is normal behavior.

2. **Sampling Parameters**:
   - Use Temperature=0.6, TopP=0.95, MinP=0 instead of Greedy decoding to avoid endless repetitions.
   - Use TopK between 20 and 40 to filter out rare token occurrences while maintaining the diversity of the generated output.
   - For supported frameworks, you can adjust the `presence_penalty` parameter between 0 and 2 to reduce endless repetitions. However, using a higher value may result in occasional language mixing and a slight decrease in performance.

3. **No Thinking Content in History**: In multi-turn conversations, the historical model output should only include the final output part and does not need to include the thinking content. This feature is already implemented in `apply_chat_template`.

4. **Standardize Output Format**: We recommend using prompts to standardize model outputs when benchmarking.
   - **Math Problems**: Include "Please reason step by step, and put your final answer within \boxed{}." in the prompt.
   - **Multiple-Choice Questions**: Add the following JSON structure to the prompt to standardize responses: "Please show your choice in the `answer` field with only the choice letter, e.g.,`\"answer\": \"C\"`." in the prompt.

5. **Handle Long Inputs**: For inputs exceeding 8,192 tokens, enable [YaRN](https://arxiv.org/abs/2309.00071) to improve the model's ability to capture long-sequence information effectively.

    For supported frameworks, you could add the following to `config.json` to enable YaRN:
    ```json
    {
    ...,
    "rope_scaling": {
        "factor": 4.0,
        "original_max_position_embeddings": 32768,
        "type": "yarn"
    }
    }
    ```

    For deployment, we recommend using vLLM. Please refer to our [Documentation](https://qwen.readthedocs.io/en/latest/deployment/vllm.html) for usage if you are not familar with vLLM.
    Presently, vLLM only supports static YARN, which means the scaling factor remains constant regardless of input length, **potentially impacting performance on shorter texts**. 
    We advise adding the `rope_scaling` configuration only when processing long contexts is required.

## Evaluation & Performance

Detailed evaluation results are reported in this [ğŸ“‘ blog](https://qwenlm.github.io/blog/qwq-32b/).

For requirements on GPU memory and the respective throughput, see results [here](https://qwen.readthedocs.io/en/latest/benchmark/speed_benchmark.html).

## Citation

If you find our work helpful, feel free to give us a cite.

```
@misc{qwq32b,
    title = {QwQ-32B: Embracing the Power of Reinforcement Learning},
    url = {https://qwenlm.github.io/blog/qwq-32b/},
    author = {Qwen Team},
    month = {March},
    year = {2025}
}

@article{qwen2.5,
      title={Qwen2.5 Technical Report}, 
      author={An Yang and Baosong Yang and Beichen Zhang and Binyuan Hui and Bo Zheng and Bowen Yu and Chengyuan Li and Dayiheng Liu and Fei Huang and Haoran Wei and Huan Lin and Jian Yang and Jianhong Tu and Jianwei Zhang and Jianxin Yang and Jiaxi Yang and Jingren Zhou and Junyang Lin and Kai Dang and Keming Lu and Keqin Bao and Kexin Yang and Le Yu and Mei Li and Mingfeng Xue and Pei Zhang and Qin Zhu and Rui Men and Runji Lin and Tianhao Li and Tianyi Tang and Tingyu Xia and Xingzhang Ren and Xuancheng Ren and Yang Fan and Yang Su and Yichang Zhang and Yu Wan and Yuqiong Liu and Zeyu Cui and Zhenru Zhang and Zihan Qiu},
      journal={arXiv preprint arXiv:2412.15115},
      year={2024}
}
```</div> </div> </section> <div class="border-b border-gray-200 dark:border-gray-700 mb-6"> <nav class="-mb-px flex space-x-8" aria-label="Secondary Tabs"> <button id="tab-btn-files" class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-xl focus:outline-none active-tab">
Files
</button> <button id="tab-btn-community" class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-xl focus:outline-none inactive-tab">
Community
</button> </nav> </div> <div id="tab-content" class="mt-6"> <div id="tab-files" class="tab-panel"> <h2 class="text-2xl font-semibold mb-4 text-gray-800 dark:text-gray-200">Files and Versions</h2> <p class="text-gray-600 dark:text-gray-400">This section will list the model files. (Functionality to be implemented)</p> <div class="ad-container my-4 mt-10">  <div id="amazon-ad-YOUR_AMAZON_DETAIL_PAGE_AD_ID" style="width:100%;height:250px">  </div>  </div> </div> <div id="tab-community" class="tab-panel hidden"> <h2 class="text-2xl font-semibold mb-4 text-gray-800 dark:text-gray-200">Community Discussions</h2> <p class="text-gray-600 dark:text-gray-400">This section will display community discussions and showcase user-created content. (Functionality to be implemented)</p> </div> </div> </div> <aside class="lg:col-span-1"> <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg sticky top-6 shadow-md border border-gray-100 dark:border-gray-600"> <h3 class="text-2xl font-bold mb-4 text-gray-900 dark:text-white border-b pb-2">Model Details</h3> <div class="space-y-3 text-gray-700 dark:text-gray-300"> <div class="flex items-center gap-2"> <span class="text-xl">âš™ï¸</span> <span class="font-semibold">Task:</span> <span class="break-all">text-generation</span> </div> <div class="flex items-center gap-2"> <span class="text-xl">â¤ï¸</span> <span class="font-semibold">Likes:</span> <span>2,863</span> </div> <div class="flex items-center gap-2"> <span class="text-xl">â¬‡ï¸</span> <span class="font-semibold">Downloads:</span> <span>53,346</span> </div> <div class="flex items-center gap-2"> <span class="text-xl">ğŸ“…</span> <span class="font-semibold">Updated:</span> <span>N/A</span> </div> </div> <div class="mt-6 border-t border-gray-200 dark:border-gray-600 pt-6"> <h4 class="font-bold text-lg mb-3 text-gray-900 dark:text-white">Sources & Repositories</h4> <ul class="space-y-2"> <li> <a href="https://huggingface.co/Qwen/QwQ-32B" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400 hover:underline transition-colors break-all flex items-center gap-1"> <span>Hugging Face</span> <span class="ml-1 text-sm">&rarr;</span> </a> </li> </ul> </div> </div> </aside> </div> </article> </div> <script>(function(){const allTags = ["transformers","safetensors","qwen2","text-generation","chat","conversational","en","arxiv:2309.00071","arxiv:2412.15115","base_model:Qwen/Qwen2.5-32B","base_model:finetune:Qwen/Qwen2.5-32B","license:apache-2.0","autotrain_compatible","text-generation-inference","endpoints_compatible","region:us"];
const hasMoreTags = true;

Â  Â  // Tab switching logic
Â  Â  const tabButtons = document.querySelectorAll('.tab-button');
Â  Â  const tabPanels = document.querySelectorAll('.tab-panel');
Â  Â  const tabIdMap = {
Â  Â  Â  'tab-btn-files': 'tab-files',
Â  Â  Â  'tab-btn-community': 'tab-community',
Â  Â  };

Â  Â  tabButtons.forEach(button => {
Â  Â  Â  button.addEventListener('click', () => {
Â  Â  Â  Â  // Update active tab
Â  Â  Â  Â  tabButtons.forEach(t => t.classList.replace('active-tab', 'inactive-tab'));
Â  Â  Â  Â  button.classList.replace('inactive-tab', 'active-tab');

Â  Â  Â  Â  // Get the target panel ID
Â  Â  Â  Â  const targetPanelId = tabIdMap[button.id];

Â  Â  Â  Â  // Update panel visibility
Â  Â  Â  Â  tabPanels.forEach(p => p.classList.add('hidden'));
Â  Â  Â  Â  if (targetPanelId) {
Â  Â  Â  Â  Â  document.getElementById(targetPanelId)?.classList.remove('hidden');
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  });


Â  Â  // "Show all tags" button logic
Â  Â  if (hasMoreTags) {
Â  Â  Â  const showAllBtn = document.getElementById('show-all-tags');
Â  Â  Â  const tagsContainer = document.getElementById('tags-container');

Â  Â  Â  if (showAllBtn && tagsContainer) {
Â  Â  Â  Â  showAllBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  const remainingTags = allTags.slice(15);
Â  Â  Â  Â  Â  const tagsHtml = remainingTags.map(tag =>Â 
Â  Â  Â  Â  Â  Â  `<span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300 transition-colors">${tag}</span>`
Â  Â  Â  Â  Â  ).join('');
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const tempDiv = document.createElement('div');
Â  Â  Â  Â  Â  tempDiv.innerHTML = tagsHtml;

Â  Â  Â  Â  Â  tagsContainer.append(...tempDiv.childNodes);
Â  Â  Â  Â  Â  showAllBtn.remove();
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  }
Â  })();</script>  </main> <footer class="bg-gray-800 text-gray-300 py-8 mt-16"> <div class="container mx-auto px-4 text-center"> <div class="flex justify-center gap-4 mb-4"> <a href="/about" class="hover:underline">About</a> <a href="/compliance" class="hover:underline">Compliance</a> </div> <p class="text-sm">&copy; 2025 Free AI Tools. An open-source project to index the world of AI.</p> </div> </footer> <script type="module">const e=document.getElementById("header-search");e.addEventListener("keydown",n=>{if(n.key==="Enter"){const o=e.value;window.location.href=`/explore?q=${encodeURIComponent(o)}`}});</script> </body> </html>