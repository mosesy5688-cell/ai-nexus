<!DOCTYPE html><html lang="en"> <head><!-- Google Tag Manager --><script type="module">(function(e,n,r,t,m){e[t]=e[t]||[],e[t].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s="";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-58C2CQ8G");</script><!-- End Google Tag Manager --><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><!-- Open Graph Meta Tags --><meta property="og:type" content="website"><meta property="og:url" content="https://free2aitools.com/model/TheBloke--h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ/"><meta property="og:title" content="h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ - AI Model Details"><meta property="og:description" content="A model for text-generation."><meta property="og:image" content="https://free2aitools.com/og-image.jpg"><!-- Twitter Card Meta Tags --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://free2aitools.com/model/TheBloke--h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ/"><meta property="twitter:title" content="h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ - AI Model Details"><meta property="twitter:description" content="A model for text-generation."><meta property="twitter:image" content="https://free2aitools.com/og-image.jpg"><meta name="description" content="A model for text-generation."><title>h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ - AI Model Details</title><link rel="canonical" href="https://free2aitools.com/model/TheBloke--h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ/"><!-- Google AdSense --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2292826803755214" crossorigin="anonymous"></script><link rel="stylesheet" href="/_astro/about.CAZw8hUu.css"></head> <body class="bg-gray-50 text-gray-800 font-sans antialiased flex flex-col min-h-screen"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58C2CQ8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <header class="sticky top-0 z-30 w-full backdrop-blur flex-none transition-colors duration-500 lg:border-b lg:border-gray-200 bg-white/80"> <nav class="container mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex items-center justify-between h-16"> <!-- Site Logo --> <a href="/" class="flex items-center gap-2 text-xl sm:text-2xl font-bold text-gray-900"> <span>Free AI Tools</span> </a> <!-- Right-side items --> <div class="flex items-center gap-4"> <!-- Desktop Navigation --> <div class="hidden md:flex items-center gap-6"> <a href="/" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Explore Models </a><a href="/ranking" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Rankings </a><a href="/reports" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Reports </a><a href="/about" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> About </a> </div> <!-- Mobile Search & Menu Toggle --> <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-default" aria-expanded="false"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path></svg> </button> </div> </div> <!-- Mobile Collapsible Menu --> <div class="hidden w-full md:hidden" id="navbar-default"> <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50"> <li> <a href="/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Explore Models</a> </li><li> <a href="/ranking" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Rankings</a> </li><li> <a href="/reports" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Reports</a> </li><li> <a href="/about" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">About</a> </li> </ul> </div> </nav> </header> <main class="flex-grow">  <div class="container mx-auto px-4 py-12"> <div class="max-w-4xl mx-auto"> <!-- Header Section --> <header class="mb-8"> <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4"> <div> <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-2">h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ</h1> <p class="text-lg text-gray-500 dark:text-gray-400">by </p> </div>  </div> </header> <!-- Metadata Section --> <div class="mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg"> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Likes</p> <p class="text-xl font-bold">120</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Downloads</p> <p class="text-xl font-bold">60</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Task</p> <p class="text-xl font-bold capitalize">text-generation</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Last Updated</p> <p class="text-xl font-bold">Invalid Date</p> </div> </div> </div> <h3 class="text-lg font-semibold mb-2">Sources</h3> <div class="flex flex-col gap-2"> <a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> ü§ó Hugging Face </a> </div> </div> </div>  <div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div><div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> ü§ó Hugging Face Details
</h3>   </div> <article class="model-readme-content py-8 border-t border-gray-200 dark:border-gray-700"> <div class="prose prose-lg dark:prose-invert max-w-none"> <!-- header start -->
<!-- 200823 -->
<div style="width: auto; margin-left: auto; margin-right: auto">
<img src="https://i.imgur.com/EBdldam.jpg" alt="TheBlokeAI" style="width: 100%; min-width: 400px; display: block; margin: auto;">
</div>
<div style="display: flex; justify-content: space-between; width: 100%;">
    <div style="display: flex; flex-direction: column; align-items: flex-start;">
        <p style="margin-top: 0.5em; margin-bottom: 0em;"><a href="https://discord.gg/theblokeai">Chat & support: TheBloke's Discord server</a></p>
    </div>
    <div style="display: flex; flex-direction: column; align-items: flex-end;">
        <p style="margin-top: 0.5em; margin-bottom: 0em;"><a href="https://www.patreon.com/TheBlokeAI">Want to contribute? TheBloke's Patreon page</a></p>
    </div>
</div>
<div style="text-align:center; margin-top: 0em; margin-bottom: 0em"><p style="margin-top: 0.25em; margin-bottom: 0em;">TheBloke's LLM work is generously supported by a grant from <a href="https://a16z.com">andreessen horowitz (a16z)</a></p></div>
<hr style="margin-top: 1.0em; margin-bottom: 1.0em;">
<!-- header end -->

<h1>H2O&#39;s GPT-GM-OASST1-Falcon 40B v2 GPTQ</h1>
<p>These files are GPTQ 4bit model files for <a href="https://huggingface.co/h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2">H2O&#39;s GPT-GM-OASST1-Falcon 40B v2</a>.</p>
<p>It is the result of quantising to 4bit using <a href="https://github.com/PanQiWei/AutoGPTQ">AutoGPTQ</a>.</p>
<h2>Repositories available</h2>
<ul>
<li><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ">4-bit GPTQ models for GPU inference</a></li>
<li><a href="https://huggingface.co/TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GGML">2, 3, 4, 5, 6 and 8-bit GGML models for CPU+GPU inference</a></li>
<li><a href="https://huggingface.co/h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2">Unquantised fp16 model in pytorch format, for GPU inference and for further conversions</a></li>
</ul>
<h2>Prompt template</h2>
<pre><code>&lt;|prompt|&gt;prompt&lt;|endoftext|&gt;
&lt;|answer|&gt;
</code></pre>
<h2>EXPERIMENTAL</h2>
<p>Please note this is an experimental GPTQ model. Support for it is currently quite limited.</p>
<p>It is also expected to be <strong>VERY SLOW</strong>. This is unavoidable at the moment, but is being looked at.</p>
<h2>How to download and use this model in text-generation-webui</h2>
<ol>
<li>Launch text-generation-webui</li>
<li>Click the <strong>Model tab</strong>.</li>
<li>Untick <strong>Autoload model</strong></li>
<li>Under <strong>Download custom model or LoRA</strong>, enter <code>TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ</code>.</li>
<li>Click <strong>Download</strong>.</li>
<li>Wait until it says it&#39;s finished downloading.</li>
<li>Click the <strong>Refresh</strong> icon next to <strong>Model</strong> in the top left.</li>
<li>In the <strong>Model drop-down</strong>: choose the model you just downloaded, <code>TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ</code>.</li>
<li>Make sure <strong>Loader</strong> is set to <strong>AutoGPTQ</strong>. This model will not work with ExLlama or GPTQ-for-LLaMa.</li>
<li>Tick <strong>Trust Remote Code</strong>, followed by <strong>Save Settings</strong></li>
<li>Click <strong>Reload</strong>.</li>
<li>Once it says it&#39;s loaded, click the <strong>Text Generation tab</strong> and enter a prompt!</li>
</ol>
<h2>How to use this GPTQ model from Python code</h2>
<p>First make sure you have <a href="https://github.com/PanQiWei/AutoGPTQ">AutoGPTQ</a> installed:</p>
<p><code>pip install auto-gptq</code></p>
<p>Then try the following example code:</p>
<pre><code class="language-python">from transformers import AutoTokenizer, pipeline, logging
from auto_gptq import AutoGPTQForCausalLM, BaseQuantizeConfig

model_name_or_path = &quot;TheBloke/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2-GPTQ&quot;
model_basename = &quot;model&quot;

use_triton = False

tokenizer = AutoTokenizer.from_pretrained(model_name_or_path, use_fast=True)

model = AutoGPTQForCausalLM.from_quantized(model_name_or_path,
        model_basename=model_basename,
        use_safetensors=True,
        trust_remote_code=True,
        device=&quot;cuda:0&quot;,
        use_triton=use_triton,
        quantize_config=None)

# Note: check the prompt template is correct for this model.
prompt = &quot;Tell me about AI&quot;
prompt_template=f&#39;&#39;&#39;&lt;|prompt|&gt;{prompt}&lt;|endoftext|&gt;&lt;|answer|&gt;&#39;&#39;&#39;

print(&quot;\n\n*** Generate:&quot;)

input_ids = tokenizer(prompt_template, return_tensors=&#39;pt&#39;).input_ids.cuda()
output = model.generate(inputs=input_ids, temperature=0.7, max_new_tokens=512)
print(tokenizer.decode(output[0]))

# Inference can also be done using transformers&#39; pipeline

# Prevent printing spurious transformers error when using pipeline with AutoGPTQ
logging.set_verbosity(logging.CRITICAL)

print(&quot;*** Pipeline:&quot;)
pipe = pipeline(
    &quot;text-generation&quot;,
    model=model,
    tokenizer=tokenizer,
    max_new_tokens=512,
    temperature=0.7,
    top_p=0.95,
    repetition_penalty=1.15
)

print(pipe(prompt_template)[0][&#39;generated_text&#39;])
</code></pre>
<h2>Provided files</h2>
<p><strong>gptq_model-4bit--1g.safetensors</strong></p>
<p>This will work with AutoGPTQ, ExLlama, and CUDA versions of GPTQ-for-LLaMa. There are reports of issues with Triton mode of recent GPTQ-for-LLaMa. If you have issues, please use AutoGPTQ instead.</p>
<p>It was created without group_size to lower VRAM requirements, and with --act-order (desc_act) to boost inference accuracy as much as possible.</p>
<ul>
<li><code>gptq_model-4bit--1g.safetensors</code><ul>
<li>Works with AutoGPTQ in CUDA or Triton modes.</li>
<li>LLaMa models also work with [ExLlama](<a href="https://github.com/turboderp/exllama%7D">https://github.com/turboderp/exllama}</a>, which usually provides much higher performance, and uses less VRAM, than AutoGPTQ.</li>
<li>Works with GPTQ-for-LLaMa in CUDA mode.  May have issues with GPTQ-for-LLaMa Triton mode.</li>
<li>Works with text-generation-webui, including one-click-installers.</li>
<li>Parameters: Groupsize = -1. Act Order / desc_act = True.</li>
</ul>
</li>
</ul>
<h2>FAQ</h2>
<h3>About <code>trust-remote-code</code></h3>
<p>Please be aware that this command line argument causes Python code provided by Falcon to be executed on your machine.</p>
<p>This code is required at the moment because Falcon is too new to be supported by Hugging Face transformers. At some point in the future transformers will support the model natively, and then <code>trust_remote_code</code> will no longer be needed.</p>
<p>In this repo you can see two <code>.py</code> files - these are the files that get executed. They are copied from the base repo at <a href="https://huggingface.co/tiiuae/falcon-40b-instruct">Falcon-40B-Instruct</a>.</p>
<!-- footer start -->
<!-- 200823 -->
<h2>Discord</h2>
<p>For further support, and discussions on these models and AI in general, join us at:</p>
<p><a href="https://discord.gg/theblokeai">TheBloke AI&#39;s Discord server</a></p>
<h2>Thanks, and how to contribute.</h2>
<p>Thanks to the <a href="https://chirper.ai">chirper.ai</a> team!</p>
<p>I&#39;ve had a lot of people ask if they can contribute. I enjoy providing models and helping people, and would love to be able to spend even more time doing it, as well as expanding into new projects like fine tuning/training.</p>
<p>If you&#39;re able and willing to contribute it will be most gratefully received and will help me to keep providing more models, and to start work on new AI projects.</p>
<p>Donaters will get priority support on any and all AI/LLM/model questions and requests, access to a private Discord room, plus other benefits.</p>
<ul>
<li>Patreon: <a href="https://patreon.com/TheBlokeAI">https://patreon.com/TheBlokeAI</a></li>
<li>Ko-Fi: <a href="https://ko-fi.com/TheBlokeAI">https://ko-fi.com/TheBlokeAI</a></li>
</ul>
<p><strong>Special thanks to</strong>: Aemon Algiz.</p>
<p><strong>Patreon special mentions</strong>: Sam, theTransient, Jonathan Leane, Steven Wood, webtim, Johann-Peter Hartmann, Geoffrey Montalvo, Gabriel Tamborski, Willem Michiel, John Villwock, Derek Yates, Mesiah Bishop, Eugene Pentland, Pieter, Chadd, Stephen Murray, Daniel P. Andersen, terasurfer, Brandon Frisco, Thomas Belote, Sid, Nathan LeClaire, Magnesian, Alps Aficionado, Stanislav Ovsiannikov, Alex, Joseph William Delisle, Nikolai Manek, Michael Davis, Junyu Yang, K, J, Spencer Kim, Stefan Sabev, Olusegun Samson, transmissions 11, Michael Levine, Cory Kujawski, Rainer Wilmers, zynix, Kalila, Luke @flexchar, Ajan Kanaga, Mandus, vamX, Ai Maven, Mano Prime, Matthew Berman, subjectnull, Vitor Caleffi, Clay Pascal, biorpg, alfie_i, ÈòøÊòé, Jeffrey Morgan, ya boyyy, Raymond Fosdick, knownsqashed, Olakabola, Leonard Tan, ReadyPlayerEmma, Enrico Ros, Dave, Talal Aujan, Illia Dulskyi, Sean Connelly, senxiiz, Artur Olbinski, Elle, Raven Klaugh, Fen Risland, Deep Realms, Imad Khwaja, Fred von Graf, Will Dee, usrbinkat, SuperWojo, Alexandros Triantafyllidis, Swaroop Kallakuri, Dan Guido, John Detwiler, Pedro Madruga, Iucharbius, Viktor Bowallius, Asp the Wyvern, Edmond Seymore, Trenton Dambrowitz, Space Cruiser, Spiking Neurons AB, Pyrater, LangChain4j, Tony Hughes, Kacper Wikie≈Ç, Rishabh Srivastava, David Ziegler, Luke Pendergrass, Andrey, Gabriel Puliatti, Lone Striker, Sebastain Graf, Pierre Kircher, Randy H, NimbleBox.ai, Vadim, danny, Deo Leter</p>
<p>Thank you to all my generous patrons and donaters!</p>
<p>And thank you again to a16z for their generous grant.</p>
<!-- footer end -->

<h1>Original model card: H2O&#39;s GPT-GM-OASST1-Falcon 40B v2</h1>
<h1>Model Card</h1>
<h2>Summary</h2>
<p>This model was trained using <a href="https://github.com/h2oai/h2o-llmstudio">H2O LLM Studio</a>.</p>
<ul>
<li>Base model: <a href="https://huggingface.co/tiiuae/falcon-40b">tiiuae/falcon-40b</a></li>
<li>Dataset preparation: <a href="https://github.com/h2oai/h2o-llmstudio/blob/1935d84d9caafed3ee686ad2733eb02d2abfce57/app_utils/utils.py#LL1896C5-L1896C28">OpenAssistant/oasst1</a></li>
</ul>
<h2>Usage</h2>
<p>To use the model with the <code>transformers</code> library on a machine with GPUs, first make sure you have the <code>transformers</code>, <code>accelerate</code> and <code>torch</code> libraries installed.</p>
<pre><code class="language-bash">pip install transformers==4.29.2
pip install bitsandbytes==0.39.0
pip install accelerate==0.19.0
pip install torch==2.0.0
pip install einops==0.6.1
</code></pre>
<pre><code class="language-python">import torch
from transformers import pipeline, BitsAndBytesConfig, AutoTokenizer

model_kwargs = {}

quantization_config = None
# optional quantization
quantization_config = BitsAndBytesConfig(
    load_in_8bit=True,
    llm_int8_threshold=6.0,
)
model_kwargs[&quot;quantization_config&quot;] = quantization_config

tokenizer = AutoTokenizer.from_pretrained(
    &quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    use_fast=False,
    padding_side=&quot;left&quot;,
    trust_remote_code=True,
)

generate_text = pipeline(
    model=&quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    tokenizer=tokenizer,
    torch_dtype=torch.float16,
    trust_remote_code=True,
    use_fast=False,
    device_map={&quot;&quot;: &quot;cuda:0&quot;},
    model_kwargs=model_kwargs,
)

res = generate_text(
    &quot;Why is drinking water so healthy?&quot;,
    min_new_tokens=2,
    max_new_tokens=1024,
    do_sample=False,
    num_beams=1,
    temperature=float(0.3),
    repetition_penalty=float(1.2),
    renormalize_logits=True
)
print(res[0][&quot;generated_text&quot;])
</code></pre>
<p>You can print a sample prompt after the preprocessing step to see how it is feed to the tokenizer:</p>
<pre><code class="language-python">print(generate_text.preprocess(&quot;Why is drinking water so healthy?&quot;)[&quot;prompt_text&quot;])
</code></pre>
<pre><code class="language-bash">&lt;|prompt|&gt;Why is drinking water so healthy?&lt;|endoftext|&gt;&lt;|answer|&gt;
</code></pre>
<p>Alternatively, you can download <a href="h2oai_pipeline.py">h2oai_pipeline.py</a>, store it alongside your notebook, and construct the pipeline yourself from the loaded model and tokenizer:</p>
<pre><code class="language-python">import torch
from h2oai_pipeline import H2OTextGenerationPipeline
from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig

quantization_config = None
# optional quantization
quantization_config = BitsAndBytesConfig(
    load_in_8bit=True,
    llm_int8_threshold=6.0,
)

tokenizer = AutoTokenizer.from_pretrained(
    &quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    use_fast=False,
    padding_side=&quot;left&quot;,
    trust_remote_code=True,
)
model = AutoModelForCausalLM.from_pretrained(
    &quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    trust_remote_code=True,
    torch_dtype=torch.float16,
    device_map={&quot;&quot;: &quot;cuda:0&quot;},
    quantization_config=quantization_config
).eval()
generate_text = H2OTextGenerationPipeline(model=model, tokenizer=tokenizer)

res = generate_text(
    &quot;Why is drinking water so healthy?&quot;,
    min_new_tokens=2,
    max_new_tokens=1024,
    do_sample=False,
    num_beams=1,
    temperature=float(0.3),
    repetition_penalty=float(1.2),
    renormalize_logits=True
)
print(res[0][&quot;generated_text&quot;])
</code></pre>
<p>You may also construct the pipeline from the loaded model and tokenizer yourself and consider the preprocessing steps:</p>
<pre><code class="language-python">from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig

# Important: The prompt needs to be in the same format the model was trained with.
# You can find an example prompt in the experiment logs.
prompt = &quot;&lt;|prompt|&gt;How are you?&lt;|endoftext|&gt;&lt;|answer|&gt;&quot;

quantization_config = None
# optional quantization
quantization_config = BitsAndBytesConfig(
    load_in_8bit=True,
    llm_int8_threshold=6.0,
)

tokenizer = AutoTokenizer.from_pretrained(
    &quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    use_fast=False,
    padding_side=&quot;left&quot;,
    trust_remote_code=True,
)
model = AutoModelForCausalLM.from_pretrained(
    &quot;h2oai/h2ogpt-gm-oasst1-en-2048-falcon-40b-v2&quot;,
    trust_remote_code=True,
    torch_dtype=torch.float16,
    device_map={&quot;&quot;: &quot;cuda:0&quot;},
    quantization_config=quantization_config
).eval()

inputs = tokenizer(prompt, return_tensors=&quot;pt&quot;, add_special_tokens=False).to(&quot;cuda&quot;)

# generate configuration can be modified to your needs
tokens = model.generate(
    **inputs,
    min_new_tokens=2,
    max_new_tokens=1024,
    do_sample=False,
    num_beams=1,
    temperature=float(0.3),
    repetition_penalty=float(1.2),
    renormalize_logits=True
)[0]

tokens = tokens[inputs[&quot;input_ids&quot;].shape[1]:]
answer = tokenizer.decode(tokens, skip_special_tokens=True)
print(answer)
</code></pre>
<h2>Model Architecture</h2>
<pre><code>RWForCausalLM(
  (transformer): RWModel(
    (word_embeddings): Embedding(65024, 8192)
    (h): ModuleList(
      (0-59): 60 x DecoderLayer(
        (ln_attn): LayerNorm((8192,), eps=1e-05, elementwise_affine=True)
        (ln_mlp): LayerNorm((8192,), eps=1e-05, elementwise_affine=True)
        (self_attention): Attention(
          (maybe_rotary): RotaryEmbedding()
          (query_key_value): Linear(in_features=8192, out_features=9216, bias=False)
          (dense): Linear(in_features=8192, out_features=8192, bias=False)
          (attention_dropout): Dropout(p=0.0, inplace=False)
        )
        (mlp): MLP(
          (dense_h_to_4h): Linear(in_features=8192, out_features=32768, bias=False)
          (act): GELU(approximate=&#39;none&#39;)
          (dense_4h_to_h): Linear(in_features=32768, out_features=8192, bias=False)
        )
      )
    )
    (ln_f): LayerNorm((8192,), eps=1e-05, elementwise_affine=True)
  )
  (lm_head): Linear(in_features=8192, out_features=65024, bias=False)
)
</code></pre>
<h2>Model Configuration</h2>
<p>This model was trained using H2O LLM Studio and with the configuration in <a href="cfg.yaml">cfg.yaml</a>. Visit <a href="https://github.com/h2oai/h2o-llmstudio">H2O LLM Studio</a> to learn how to train your own large language models.</p>
<h2>Disclaimer</h2>
<p>Please read this disclaimer carefully before using the large language model provided in this repository. Your use of the model signifies your agreement to the following terms and conditions.</p>
<ul>
<li>Biases and Offensiveness: The large language model is trained on a diverse range of internet text data, which may contain biased, racist, offensive, or otherwise inappropriate content. By using this model, you acknowledge and accept that the generated content may sometimes exhibit biases or produce content that is offensive or inappropriate. The developers of this repository do not endorse, support, or promote any such content or viewpoints.</li>
<li>Limitations: The large language model is an AI-based tool and not a human. It may produce incorrect, nonsensical, or irrelevant responses. It is the user&#39;s responsibility to critically evaluate the generated content and use it at their discretion.</li>
<li>Use at Your Own Risk: Users of this large language model must assume full responsibility for any consequences that may arise from their use of the tool. The developers and contributors of this repository shall not be held liable for any damages, losses, or harm resulting from the use or misuse of the provided model.</li>
<li>Ethical Considerations: Users are encouraged to use the large language model responsibly and ethically. By using this model, you agree not to use it for purposes that promote hate speech, discrimination, harassment, or any form of illegal or harmful activities.</li>
<li>Reporting Issues: If you encounter any biased, offensive, or otherwise inappropriate content generated by the large language model, please report it to the repository maintainers through the provided channels. Your feedback will help improve the model and mitigate potential issues.</li>
<li>Changes to this Disclaimer: The developers of this repository reserve the right to modify or update this disclaimer at any time without prior notice. It is the user&#39;s responsibility to periodically review the disclaimer to stay informed about any changes.</li>
</ul>
<p>By using the large language model provided in this repository, you agree to accept and comply with the terms and conditions outlined in this disclaimer. If you do not agree with any part of this disclaimer, you should refrain from using the model and any content generated by it.</p>
 </div> </article>  <section class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"> <h2 class="text-3xl font-bold text-center mb-8">Related Models</h2> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"> <a href="/model/h2oai--h2ogpt-gm-oasst1-en-2048-falcon-40b-v1" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="h2ogpt-gm-oasst1-en-2048-falcon-40b-v1"> h2ogpt-gm-oasst1-en-2048-falcon-40b-v1 </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="465 likes">‚ù§Ô∏è <span>465</span></div> <div class="flex items-center gap-1" title="1,755 downloads">üì• <span>1.8K</span></div> </div> </div> </a><a href="/model/h2oai--h2ogpt-gm-oasst1-en-2048-falcon-40b-v2" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="h2ogpt-gm-oasst1-en-2048-falcon-40b-v2"> h2ogpt-gm-oasst1-en-2048-falcon-40b-v2 </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="270 likes">‚ù§Ô∏è <span>270</span></div> <div class="flex items-center gap-1" title="1,680 downloads">üì• <span>1.7K</span></div> </div> </div> </a><a href="/model/h2oai--h2ogpt-gm-oasst1-en-2048-falcon-7b-v3" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full">  <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="h2ogpt-gm-oasst1-en-2048-falcon-7b-v3"> h2ogpt-gm-oasst1-en-2048-falcon-7b-v3 </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by </p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A model for text-generation....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="1,095 likes">‚ù§Ô∏è <span>1.1K</span></div> <div class="flex items-center gap-1" title="5,385 downloads">üì• <span>5.4K</span></div> </div> </div> </a> </div> </section> </main> <footer class="bg-gray-800 text-gray-300 py-8 mt-16"> <div class="container mx-auto px-4 text-center"> <div class="flex justify-center gap-4 mb-4"> <a href="/about" class="hover:underline">About</a> <a href="/compliance" class="hover:underline">Compliance</a> </div> <p class="text-sm mt-2">
&copy; 2025 Free AI Tools. An open-source project to index the world of AI.
</p> <a href="mailto:compliance@free2aitools.com" class="text-sm text-gray-400 hover:underline mt-1 block">compliance@free2aitools.com</a> </div> </footer> </body></html>