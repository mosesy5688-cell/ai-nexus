<!DOCTYPE html><html lang="en"> <head><!-- Google Tag Manager --><script type="module">(function(e,n,r,t,m){e[t]=e[t]||[],e[t].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s="";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-58C2CQ8G");</script><!-- End Google Tag Manager --><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><!-- Open Graph Meta Tags --><meta property="og:type" content="website"><meta property="og:url" content="https://free2aitools.com/model/github-HKUDS-LightRAG/"><meta property="og:title" content="LightRAG - AI Model Details"><meta property="og:description" content="[EMNLP2025] &#34;LightRAG: Simple and Fast Retrieval-Augmented Generation&#34;"><meta property="og:image" content="https://free2aitools.com/og-image.jpg"><!-- Twitter Card Meta Tags --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://free2aitools.com/model/github-HKUDS-LightRAG/"><meta property="twitter:title" content="LightRAG - AI Model Details"><meta property="twitter:description" content="[EMNLP2025] &#34;LightRAG: Simple and Fast Retrieval-Augmented Generation&#34;"><meta property="twitter:image" content="https://free2aitools.com/og-image.jpg"><meta name="description" content="[EMNLP2025] &#34;LightRAG: Simple and Fast Retrieval-Augmented Generation&#34;"><title>LightRAG - AI Model Details</title><link rel="canonical" href="https://free2aitools.com/model/github-HKUDS-LightRAG/"><!-- Google AdSense --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2292826803755214" crossorigin="anonymous"></script><link rel="stylesheet" href="/_astro/about.CAZw8hUu.css"></head> <body class="bg-gray-50 text-gray-800 font-sans antialiased flex flex-col min-h-screen"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58C2CQ8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <header class="sticky top-0 z-30 w-full backdrop-blur flex-none transition-colors duration-500 lg:border-b lg:border-gray-200 bg-white/80"> <nav class="container mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex items-center justify-between h-16"> <!-- Site Logo --> <a href="/" class="flex items-center gap-2 text-xl sm:text-2xl font-bold text-gray-900"> <span>Free AI Tools</span> </a> <!-- Right-side items --> <div class="flex items-center gap-4"> <!-- Desktop Navigation --> <div class="hidden md:flex items-center gap-6"> <a href="/" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Explore Models </a><a href="/ranking" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Rankings </a><a href="/reports" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Reports </a><a href="/about" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> About </a> </div> <!-- Mobile Search & Menu Toggle --> <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-default" aria-expanded="false"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path></svg> </button> </div> </div> <!-- Mobile Collapsible Menu --> <div class="hidden w-full md:hidden" id="navbar-default"> <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50"> <li> <a href="/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Explore Models</a> </li><li> <a href="/ranking" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Rankings</a> </li><li> <a href="/reports" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Reports</a> </li><li> <a href="/about" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">About</a> </li> </ul> </div> </nav> </header> <main class="flex-grow">  <div class="container mx-auto px-4 py-12"> <div class="max-w-4xl mx-auto"> <!-- Header Section --> <header class="mb-8"> <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4"> <div> <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-2">LightRAG</h1> <p class="text-lg text-gray-500 dark:text-gray-400">by HKUDS</p> </div>  </div> </header> <!-- Metadata Section --> <div class="mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg"> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Likes</p> <p class="text-xl font-bold">47,760</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Downloads</p> <p class="text-xl font-bold">47,760</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Task</p> <p class="text-xl font-bold capitalize">tool</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Last Updated</p> <p class="text-xl font-bold">2025/11/20</p> </div> </div> </div> <h3 class="text-lg font-semibold mb-2">Sources</h3> <div class="flex flex-col gap-2"> <a href="https://github.com/HKUDS/LightRAG" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> üì¶ GitHub </a> </div> </div> </div>  <div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> üì¶ GitHub Details
</h3> <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"> <div><strong>Language:</strong> Python</div> <div><strong>Stars:</strong> 47,760</div> <div><strong>Forks:</strong> 3,507</div> <div><strong>Open Issues:</strong> 170</div> <div><strong>License:</strong> MIT License</div> <div><a href="https://arxiv.org/abs/2410.05779" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline"><strong>Project Homepage ‚Üó</strong></a></div> </div>  </div> <article class="model-readme-content py-8 border-t border-gray-200 dark:border-gray-700"> <div class="prose prose-lg dark:prose-invert max-w-none"> <div align="center">

<div style="margin: 20px 0;">
  <img src="./assets/logo.png" width="120" height="120" alt="LightRAG Logo" style="border-radius: 20px; box-shadow: 0 8px 32px rgba(0, 217, 255, 0.3);">
</div>

<h1>üöÄ LightRAG: Simple and Fast Retrieval-Augmented Generation</h1>
<div align="center">
    <a href="https://trendshift.io/repositories/13043" target="_blank"><img src="https://trendshift.io/api/badge/repositories/13043" alt="HKUDS%2FLightRAG | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>
</div>

<div align="center">
  <div style="width: 100%; height: 2px; margin: 20px 0; background: linear-gradient(90deg, transparent, #00d9ff, transparent);"></div>
</div>

<div align="center">
  <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 25px; text-align: center;">
    <p>
      <a href='https://github.com/HKUDS/LightRAG'><img src='https://img.shields.io/badge/üî•Project-Page-00d9ff?style=for-the-badge&logo=github&logoColor=white&labelColor=1a1a2e'></a>
      <a href='https://arxiv.org/abs/2410.05779'><img src='https://img.shields.io/badge/üìÑarXiv-2410.05779-ff6b6b?style=for-the-badge&logo=arxiv&logoColor=white&labelColor=1a1a2e'></a>
      <a href="https://github.com/HKUDS/LightRAG/stargazers"><img src='https://img.shields.io/github/stars/HKUDS/LightRAG?color=00d9ff&style=for-the-badge&logo=star&logoColor=white&labelColor=1a1a2e' /></a>
    </p>
    <p>
      <img src="https://img.shields.io/badge/üêçPython-3.10-4ecdc4?style=for-the-badge&logo=python&logoColor=white&labelColor=1a1a2e">
      <a href="https://pypi.org/project/lightrag-hku/"><img src="https://img.shields.io/pypi/v/lightrag-hku.svg?style=for-the-badge&logo=pypi&logoColor=white&labelColor=1a1a2e&color=ff6b6b"></a>
    </p>
    <p>
      <a href="https://discord.gg/yF2MmDJyGJ"><img src="https://img.shields.io/badge/üí¨Discord-Community-7289da?style=for-the-badge&logo=discord&logoColor=white&labelColor=1a1a2e"></a>
      <a href="https://github.com/HKUDS/LightRAG/issues/285"><img src="https://img.shields.io/badge/üí¨WeChat-Group-07c160?style=for-the-badge&logo=wechat&logoColor=white&labelColor=1a1a2e"></a>
    </p>
    <p>
      <a href="README-zh.md"><img src="https://img.shields.io/badge/üá®üá≥‰∏≠ÊñáÁâà-1a1a2e?style=for-the-badge"></a>
      <a href="README.md"><img src="https://img.shields.io/badge/üá∫üá∏English-1a1a2e?style=for-the-badge"></a>
    </p>
    <p>
      <a href="https://pepy.tech/projects/lightrag-hku"><img src="https://static.pepy.tech/personalized-badge/lightrag-hku?period=total&units=INTERNATIONAL_SYSTEM&left_color=BLACK&right_color=GREEN&left_text=downloads"></a>
    </p>
  </div>
</div>

</div>

<div align="center" style="margin: 30px 0;">
  <img src="https://user-images.githubusercontent.com/74038190/212284100-561aa473-3905-4a80-b561-0d28506553ee.gif" width="800">
</div>

<div align="center" style="margin: 30px 0;">
    <img src="./README.assets/b2aaf634151b4706892693ffb43d9093.png" width="800" alt="LightRAG Diagram">
</div>

<hr>
<h2>üéâ News</h2>
<ul>
<li>[2025.11.05]üéØAdd <strong>RAGAS-based</strong> Evaluation Framework and <strong>Langfuse</strong> observability for LightRAG (API can return retrieved contexts with query results).</li>
<li>[2025.10.22]üéØEliminate bottlenecks in processing <strong>large-scale datasets</strong>.</li>
<li>[2025.09.15]üéØSignificantly enhances KG extraction accuracy for <strong>small LLMs</strong> like Qwen3-30B-A3B.</li>
<li>[2025.08.29]üéØ<strong>Reranker</strong> is supported now , significantly boosting performance for mixed queries(Set as default query mode now).</li>
<li>[2025.08.04]üéØ<strong>Document deletion</strong> with KG regeneration to ensure query performance.</li>
<li>[2025.06.16]üéØOur team has released <a href="https://github.com/HKUDS/RAG-Anything">RAG-Anything</a> an All-in-One Multimodal RAG System for seamless text, image, table, and equation processing.</li>
<li>[2025.06.05]üéØLightRAG now supports comprehensive multimodal data handling through <a href="https://github.com/HKUDS/RAG-Anything">RAG-Anything</a> integration, enabling seamless document parsing and RAG capabilities across diverse formats including PDFs, images, Office documents, tables, and formulas. Please refer to the new <a href="https://github.com/HKUDS/LightRAG/?tab=readme-ov-file#multimodal-document-processing-rag-anything-integration">multimodal section</a> for details.</li>
<li>[2025.03.18]üéØLightRAG now supports citation functionality, enabling proper source attribution.</li>
<li>[2025.02.12]üéØYou can now use MongoDB as all in-one Storage.</li>
<li>[2025.02.05]üéØOur team has released <a href="https://github.com/HKUDS/VideoRAG">VideoRAG</a> understanding extremely long-context videos.</li>
<li>[2025.01.13]üéØOur team has released <a href="https://github.com/HKUDS/MiniRAG">MiniRAG</a> making RAG simpler with small models.</li>
<li>[2025.01.06]üéØYou can now use PostgreSQL as all in-one Storage.</li>
<li>[2024.11.19]üéØA comprehensive guide to LightRAG is now available on <a href="https://learnopencv.com/lightrag">LearnOpenCV</a>. Many thanks to the blog author.</li>
<li>[2024.11.09]üéØIntroducing the LightRAG Webui, which allows you to insert, query, visualize LightRAG knowledge.</li>
<li>[2024.11.04]üéØYou can now <a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#using-neo4j-for-storage">use Neo4J for Storage</a>.</li>
<li>[2024.10.18]üéØWe&#39;ve added a link to a <a href="https://youtu.be/oageL-1I0GE">LightRAG Introduction Video</a>. Thanks to the author!</li>
<li>[2024.10.17]üéØWe have created a <a href="https://discord.gg/yF2MmDJyGJ">Discord channel</a>! Welcome to join for sharing and discussions! üéâüéâ</li>
<li>[2024.10.16]üéØLightRAG now supports <a href="https://github.com/HKUDS/LightRAG?tab=readme-ov-file#quick-start">Ollama models</a>!</li>
</ul>
<details>
  <summary style="font-size: 1.4em; font-weight: bold; cursor: pointer; display: list-item;">
    Algorithm Flowchart
  </summary>

<p><img src="https://learnopencv.com/wp-content/uploads/2024/11/LightRAG-VectorDB-Json-KV-Store-Indexing-Flowchart-scaled.jpg" alt="LightRAG Indexing Flowchart">
<em>Figure 1: LightRAG Indexing Flowchart - Img Caption : <a href="https://learnopencv.com/lightrag/">Source</a></em>
<img src="https://learnopencv.com/wp-content/uploads/2024/11/LightRAG-Querying-Flowchart-Dual-Level-Retrieval-Generation-Knowledge-Graphs-scaled.jpg" alt="LightRAG Retrieval and Querying Flowchart">
<em>Figure 2: LightRAG Retrieval and Querying Flowchart - Img Caption : <a href="https://learnopencv.com/lightrag/">Source</a></em></p>
</details>

<h2>Installation</h2>
<blockquote>
<p><strong>üí° Using uv for Package Management</strong>: This project uses <a href="https://docs.astral.sh/uv/">uv</a> for fast and reliable Python package management.
Install uv first: <code>curl -LsSf https://astral.sh/uv/install.sh | sh</code> (Unix/macOS) or <code>powershell -c &quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</code> (Windows)</p>
<p><strong>Note</strong>: You can also use pip if you prefer, but uv is recommended for better performance and more reliable dependency management.</p>
<p><strong>üì¶ Offline Deployment</strong>: For offline or air-gapped environments, see the <a href="./docs/OfflineDeployment.md">Offline Deployment Guide</a> for instructions on pre-installing all dependencies and cache files.</p>
</blockquote>
<h3>Install LightRAG Server</h3>
<p>The LightRAG Server is designed to provide Web UI and API support. The Web UI facilitates document indexing, knowledge graph exploration, and a simple RAG query interface. LightRAG Server also provide an Ollama compatible interfaces, aiming to emulate LightRAG as an Ollama chat model. This allows AI chat bot, such as Open WebUI, to access LightRAG easily.</p>
<ul>
<li>Install from PyPI</li>
</ul>
<pre><code class="language-bash"># Using uv (recommended)
uv pip install &quot;lightrag-hku[api]&quot;
# Or using pip
# pip install &quot;lightrag-hku[api]&quot;

cp env.example .env  # Update the .env with your LLM and embedding configurations

lightrag-server
</code></pre>
<ul>
<li>Installation from Source</li>
</ul>
<pre><code class="language-bash">git clone https://github.com/HKUDS/LightRAG.git
cd LightRAG

# Using uv (recommended)
# Note: uv sync automatically creates a virtual environment in .venv/
uv sync --extra api
source .venv/bin/activate  # Activate the virtual environment (Linux/macOS)
# Or on Windows: .venv\Scripts\activate

# Or using pip with virtual environment
# python -m venv .venv
# source .venv/bin/activate  # Windows: .venv\Scripts\activate
# pip install -e &quot;.[api]&quot;

cp env.example .env  # Update the .env with your LLM and embedding configurations

# Build front-end artifacts
cd lightrag_webui
bun install --frozen-lockfile
bun run build
cd ..

lightrag-server
</code></pre>
<ul>
<li>Launching the LightRAG Server with Docker Compose</li>
</ul>
<pre><code class="language-bash">git clone https://github.com/HKUDS/LightRAG.git
cd LightRAG
cp env.example .env  # Update the .env with your LLM and embedding configurations
# modify LLM and Embedding settings in .env
docker compose up
</code></pre>
<blockquote>
<p>Historical versions of LightRAG docker images can be found here: <a href="https://github.com/HKUDS/LightRAG/pkgs/container/lightrag">LightRAG Docker Images</a></p>
</blockquote>
<h3>Install  LightRAG Core</h3>
<ul>
<li>Install from source (Recommended)</li>
</ul>
<pre><code class="language-bash">cd LightRAG
# Note: uv sync automatically creates a virtual environment in .venv/
uv sync
source .venv/bin/activate  # Activate the virtual environment (Linux/macOS)
# Or on Windows: .venv\Scripts\activate

# Or: pip install -e .
</code></pre>
<ul>
<li>Install from PyPI</li>
</ul>
<pre><code class="language-bash">uv pip install lightrag-hku
# Or: pip install lightrag-hku
</code></pre>
<h2>Quick Start</h2>
<h3>LLM and Technology Stack Requirements for LightRAG</h3>
<p>LightRAG&#39;s demands on the capabilities of Large Language Models (LLMs) are significantly higher than those of traditional RAG, as it requires the LLM to perform entity-relationship extraction tasks from documents. Configuring appropriate Embedding and Reranker models is also crucial for improving query performance.</p>
<ul>
<li><strong>LLM Selection</strong>:<ul>
<li>It is recommended to use an LLM with at least 32 billion parameters.</li>
<li>The context length should be at least 32KB, with 64KB being recommended.</li>
<li>It is not recommended to choose reasoning models during the document indexing stage.</li>
<li>During the query stage, it is recommended to choose models with stronger capabilities than those used in the indexing stage to achieve better query results.</li>
</ul>
</li>
<li><strong>Embedding Model</strong>:<ul>
<li>A high-performance Embedding model is essential for RAG.</li>
<li>We recommend using mainstream multilingual Embedding models, such as: <code>BAAI/bge-m3</code> and <code>text-embedding-3-large</code>.</li>
<li><strong>Important Note</strong>: The Embedding model must be determined before document indexing, and the same model must be used during the document query phase. For certain storage solutions (e.g., PostgreSQL), the vector dimension must be defined upon initial table creation. Therefore, when changing embedding models, it is necessary to delete the existing vector-related tables and allow LightRAG to recreate them with the new dimensions.</li>
</ul>
</li>
<li><strong>Reranker Model Configuration</strong>:<ul>
<li>Configuring a Reranker model can significantly enhance LightRAG&#39;s retrieval performance.</li>
<li>When a Reranker model is enabled, it is recommended to set the &quot;mix mode&quot; as the default query mode.</li>
<li>We recommend using mainstream Reranker models, such as: <code>BAAI/bge-reranker-v2-m3</code> or models provided by services like Jina.</li>
</ul>
</li>
</ul>
<h3>Quick Start for LightRAG Server</h3>
<ul>
<li>For more information about LightRAG Server, please refer to <a href="./lightrag/api/README.md">LightRAG Server</a>.</li>
</ul>
<h3>Quick Start for LightRAG core</h3>
<p>To get started with LightRAG core, refer to the sample codes available in the <code>examples</code> folder. Additionally, a <a href="https://www.youtube.com/watch?v=g21royNJ4fw">video demo</a> demonstration is provided to guide you through the local setup process. If you already possess an OpenAI API key, you can run the demo right away:</p>
<pre><code class="language-bash">### you should run the demo code with project folder
cd LightRAG
### provide your API-KEY for OpenAI
export OPENAI_API_KEY=&quot;sk-...your_opeai_key...&quot;
### download the demo document of &quot;A Christmas Carol&quot; by Charles Dickens
curl https://raw.githubusercontent.com/gusye1234/nano-graphrag/main/tests/mock_data.txt &gt; ./book.txt
### run the demo code
python examples/lightrag_openai_demo.py
</code></pre>
<p>For a streaming response implementation example, please see <code>examples/lightrag_openai_compatible_demo.py</code>. Prior to execution, ensure you modify the sample code&#39;s LLM and embedding configurations accordingly.</p>
<p><strong>Note 1</strong>: When running the demo program, please be aware that different test scripts may use different embedding models. If you switch to a different embedding model, you must clear the data directory (<code>./dickens</code>); otherwise, the program may encounter errors. If you wish to retain the LLM cache, you can preserve the <code>kv_store_llm_response_cache.json</code> file while clearing the data directory.</p>
<p><strong>Note 2</strong>: Only <code>lightrag_openai_demo.py</code> and <code>lightrag_openai_compatible_demo.py</code> are officially supported sample codes. Other sample files are community contributions that haven&#39;t undergone full testing and optimization.</p>
<h2>Programing with LightRAG Core</h2>
<blockquote>
<p>‚ö†Ô∏è <strong>If you would like to integrate LightRAG into your project, we recommend utilizing the REST API provided by the LightRAG Server</strong>. LightRAG Core is typically intended for embedded applications or for researchers who wish to conduct studies and evaluations.</p>
</blockquote>
<h3>‚ö†Ô∏è Important: Initialization Requirements</h3>
<p><strong>LightRAG requires explicit initialization before use.</strong> You must call <code>await rag.initialize_storages()</code> after creating a LightRAG instance, otherwise you will encounter errors.</p>
<h3>A Simple Program</h3>
<p>Use the below Python snippet to initialize LightRAG, insert text to it, and perform queries:</p>
<pre><code class="language-python">import os
import asyncio
from lightrag import LightRAG, QueryParam
from lightrag.llm.openai import gpt_4o_mini_complete, gpt_4o_complete, openai_embed
from lightrag.utils import setup_logger

setup_logger(&quot;lightrag&quot;, level=&quot;INFO&quot;)

WORKING_DIR = &quot;./rag_storage&quot;
if not os.path.exists(WORKING_DIR):
    os.mkdir(WORKING_DIR)

async def initialize_rag():
    rag = LightRAG(
        working_dir=WORKING_DIR,
        embedding_func=openai_embed,
        llm_model_func=gpt_4o_mini_complete,
    )
    # IMPORTANT: Both initialization calls are required!
    await rag.initialize_storages()  # Initialize storage backends    return rag

async def main():
    try:
        # Initialize RAG instance
        rag = await initialize_rag()
        await rag.ainsert(&quot;Your text&quot;)

        # Perform hybrid search
        mode = &quot;hybrid&quot;
        print(
          await rag.aquery(
              &quot;What are the top themes in this story?&quot;,
              param=QueryParam(mode=mode)
          )
        )

    except Exception as e:
        print(f&quot;An error occurred: {e}&quot;)
    finally:
        if rag:
            await rag.finalize_storages()

if __name__ == &quot;__main__&quot;:
    asyncio.run(main())
</code></pre>
<p>Important notes for the above snippet:</p>
<ul>
<li>Export your OPENAI_API_KEY environment variable before running the script.</li>
<li>This program uses the default storage settings for LightRAG, so all data will be persisted to WORKING_DIR/rag_storage.</li>
<li>This program demonstrates only the simplest way to initialize a LightRAG object: Injecting the embedding and LLM functions, and initializing storage and pipeline status after creating the LightRAG object.</li>
</ul>
<h3>LightRAG init parameters</h3>
<p>A full list of LightRAG init parameters:</p>
<details>
<summary> Parameters </summary>

<table>
<thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Explanation</strong></th>
<th><strong>Default</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>working_dir</strong></td>
<td><code>str</code></td>
<td>Directory where the cache will be stored</td>
<td><code>lightrag_cache+timestamp</code></td>
</tr>
<tr>
<td><strong>workspace</strong></td>
<td>str</td>
<td>Workspace name for data isolation between different LightRAG Instances</td>
<td></td>
</tr>
<tr>
<td><strong>kv_storage</strong></td>
<td><code>str</code></td>
<td>Storage type for documents and text chunks. Supported types: <code>JsonKVStorage</code>,<code>PGKVStorage</code>,<code>RedisKVStorage</code>,<code>MongoKVStorage</code></td>
<td><code>JsonKVStorage</code></td>
</tr>
<tr>
<td><strong>vector_storage</strong></td>
<td><code>str</code></td>
<td>Storage type for embedding vectors. Supported types: <code>NanoVectorDBStorage</code>,<code>PGVectorStorage</code>,<code>MilvusVectorDBStorage</code>,<code>ChromaVectorDBStorage</code>,<code>FaissVectorDBStorage</code>,<code>MongoVectorDBStorage</code>,<code>QdrantVectorDBStorage</code></td>
<td><code>NanoVectorDBStorage</code></td>
</tr>
<tr>
<td><strong>graph_storage</strong></td>
<td><code>str</code></td>
<td>Storage type for graph edges and nodes. Supported types: <code>NetworkXStorage</code>,<code>Neo4JStorage</code>,<code>PGGraphStorage</code>,<code>AGEStorage</code></td>
<td><code>NetworkXStorage</code></td>
</tr>
<tr>
<td><strong>doc_status_storage</strong></td>
<td><code>str</code></td>
<td>Storage type for documents process status. Supported types: <code>JsonDocStatusStorage</code>,<code>PGDocStatusStorage</code>,<code>MongoDocStatusStorage</code></td>
<td><code>JsonDocStatusStorage</code></td>
</tr>
<tr>
<td><strong>chunk_token_size</strong></td>
<td><code>int</code></td>
<td>Maximum token size per chunk when splitting documents</td>
<td><code>1200</code></td>
</tr>
<tr>
<td><strong>chunk_overlap_token_size</strong></td>
<td><code>int</code></td>
<td>Overlap token size between two chunks when splitting documents</td>
<td><code>100</code></td>
</tr>
<tr>
<td><strong>tokenizer</strong></td>
<td><code>Tokenizer</code></td>
<td>The function used to convert text into tokens (numbers) and back using .encode() and .decode() functions following <code>TokenizerInterface</code> protocol. If you don&#39;t specify one, it will use the default Tiktoken tokenizer.</td>
<td><code>TiktokenTokenizer</code></td>
</tr>
<tr>
<td><strong>tiktoken_model_name</strong></td>
<td><code>str</code></td>
<td>If you&#39;re using the default Tiktoken tokenizer, this is the name of the specific Tiktoken model to use. This setting is ignored if you provide your own tokenizer.</td>
<td><code>gpt-4o-mini</code></td>
</tr>
<tr>
<td><strong>entity_extract_max_gleaning</strong></td>
<td><code>int</code></td>
<td>Number of loops in the entity extraction process, appending history messages</td>
<td><code>1</code></td>
</tr>
<tr>
<td><strong>node_embedding_algorithm</strong></td>
<td><code>str</code></td>
<td>Algorithm for node embedding (currently not used)</td>
<td><code>node2vec</code></td>
</tr>
<tr>
<td><strong>node2vec_params</strong></td>
<td><code>dict</code></td>
<td>Parameters for node embedding</td>
<td><code>{&quot;dimensions&quot;: 1536,&quot;num_walks&quot;: 10,&quot;walk_length&quot;: 40,&quot;window_size&quot;: 2,&quot;iterations&quot;: 3,&quot;random_seed&quot;: 3,}</code></td>
</tr>
<tr>
<td><strong>embedding_func</strong></td>
<td><code>EmbeddingFunc</code></td>
<td>Function to generate embedding vectors from text</td>
<td><code>openai_embed</code></td>
</tr>
<tr>
<td><strong>embedding_batch_num</strong></td>
<td><code>int</code></td>
<td>Maximum batch size for embedding processes (multiple texts sent per batch)</td>
<td><code>32</code></td>
</tr>
<tr>
<td><strong>embedding_func_max_async</strong></td>
<td><code>int</code></td>
<td>Maximum number of concurrent asynchronous embedding processes</td>
<td><code>16</code></td>
</tr>
<tr>
<td><strong>llm_model_func</strong></td>
<td><code>callable</code></td>
<td>Function for LLM generation</td>
<td><code>gpt_4o_mini_complete</code></td>
</tr>
<tr>
<td><strong>llm_model_name</strong></td>
<td><code>str</code></td>
<td>LLM model name for generation</td>
<td><code>meta-llama/Llama-3.2-1B-Instruct</code></td>
</tr>
<tr>
<td><strong>summary_context_size</strong></td>
<td><code>int</code></td>
<td>Maximum tokens send to LLM to generate summaries for entity relation merging</td>
<td><code>10000</code>Ôºàconfigured by env var SUMMARY_CONTEXT_SIZE)</td>
</tr>
<tr>
<td><strong>summary_max_tokens</strong></td>
<td><code>int</code></td>
<td>Maximum token size for entity/relation description</td>
<td><code>500</code>Ôºàconfigured by env var SUMMARY_MAX_TOKENS)</td>
</tr>
<tr>
<td><strong>llm_model_max_async</strong></td>
<td><code>int</code></td>
<td>Maximum number of concurrent asynchronous LLM processes</td>
<td><code>4</code>Ôºàdefault value changed by env var MAX_ASYNC)</td>
</tr>
<tr>
<td><strong>llm_model_kwargs</strong></td>
<td><code>dict</code></td>
<td>Additional parameters for LLM generation</td>
<td></td>
</tr>
<tr>
<td><strong>vector_db_storage_cls_kwargs</strong></td>
<td><code>dict</code></td>
<td>Additional parameters for vector database, like setting the threshold for nodes and relations retrieval</td>
<td>cosine_better_than_threshold: 0.2Ôºàdefault value changed by env var COSINE_THRESHOLD)</td>
</tr>
<tr>
<td><strong>enable_llm_cache</strong></td>
<td><code>bool</code></td>
<td>If <code>TRUE</code>, stores LLM results in cache; repeated prompts return cached responses</td>
<td><code>TRUE</code></td>
</tr>
<tr>
<td><strong>enable_llm_cache_for_entity_extract</strong></td>
<td><code>bool</code></td>
<td>If <code>TRUE</code>, stores LLM results in cache for entity extraction; Good for beginners to debug your application</td>
<td><code>TRUE</code></td>
</tr>
<tr>
<td><strong>addon_params</strong></td>
<td><code>dict</code></td>
<td>Additional parameters, e.g., <code>{&quot;language&quot;: &quot;Simplified Chinese&quot;, &quot;entity_types&quot;: [&quot;organization&quot;, &quot;person&quot;, &quot;location&quot;, &quot;event&quot;]}</code>: sets example limit, entiy/relation extraction output language</td>
<td>language: English`</td>
</tr>
<tr>
<td><strong>embedding_cache_config</strong></td>
<td><code>dict</code></td>
<td>Configuration for question-answer caching. Contains three parameters: <code>enabled</code>: Boolean value to enable/disable cache lookup functionality. When enabled, the system will check cached responses before generating new answers. <code>similarity_threshold</code>: Float value (0-1), similarity threshold. When a new question&#39;s similarity with a cached question exceeds this threshold, the cached answer will be returned directly without calling the LLM. <code>use_llm_check</code>: Boolean value to enable/disable LLM similarity verification. When enabled, LLM will be used as a secondary check to verify the similarity between questions before returning cached answers.</td>
<td>Default: <code>{&quot;enabled&quot;: False, &quot;similarity_threshold&quot;: 0.95, &quot;use_llm_check&quot;: False}</code></td>
</tr>
</tbody></table>
</details>

<h3>Query Param</h3>
<p>Use QueryParam to control the behavior your query:</p>
<pre><code class="language-python">class QueryParam:
    &quot;&quot;&quot;Configuration parameters for query execution in LightRAG.&quot;&quot;&quot;

    mode: Literal[&quot;local&quot;, &quot;global&quot;, &quot;hybrid&quot;, &quot;naive&quot;, &quot;mix&quot;, &quot;bypass&quot;] = &quot;global&quot;
    &quot;&quot;&quot;Specifies the retrieval mode:
    - &quot;local&quot;: Focuses on context-dependent information.
    - &quot;global&quot;: Utilizes global knowledge.
    - &quot;hybrid&quot;: Combines local and global retrieval methods.
    - &quot;naive&quot;: Performs a basic search without advanced techniques.
    - &quot;mix&quot;: Integrates knowledge graph and vector retrieval.
    &quot;&quot;&quot;

    only_need_context: bool = False
    &quot;&quot;&quot;If True, only returns the retrieved context without generating a response.&quot;&quot;&quot;

    only_need_prompt: bool = False
    &quot;&quot;&quot;If True, only returns the generated prompt without producing a response.&quot;&quot;&quot;

    response_type: str = &quot;Multiple Paragraphs&quot;
    &quot;&quot;&quot;Defines the response format. Examples: &#39;Multiple Paragraphs&#39;, &#39;Single Paragraph&#39;, &#39;Bullet Points&#39;.&quot;&quot;&quot;

    stream: bool = False
    &quot;&quot;&quot;If True, enables streaming output for real-time responses.&quot;&quot;&quot;

    top_k: int = int(os.getenv(&quot;TOP_K&quot;, &quot;60&quot;))
    &quot;&quot;&quot;Number of top items to retrieve. Represents entities in &#39;local&#39; mode and relationships in &#39;global&#39; mode.&quot;&quot;&quot;

    chunk_top_k: int = int(os.getenv(&quot;CHUNK_TOP_K&quot;, &quot;20&quot;))
    &quot;&quot;&quot;Number of text chunks to retrieve initially from vector search and keep after reranking.
    If None, defaults to top_k value.
    &quot;&quot;&quot;

    max_entity_tokens: int = int(os.getenv(&quot;MAX_ENTITY_TOKENS&quot;, &quot;6000&quot;))
    &quot;&quot;&quot;Maximum number of tokens allocated for entity context in unified token control system.&quot;&quot;&quot;

    max_relation_tokens: int = int(os.getenv(&quot;MAX_RELATION_TOKENS&quot;, &quot;8000&quot;))
    &quot;&quot;&quot;Maximum number of tokens allocated for relationship context in unified token control system.&quot;&quot;&quot;

    max_total_tokens: int = int(os.getenv(&quot;MAX_TOTAL_TOKENS&quot;, &quot;30000&quot;))
    &quot;&quot;&quot;Maximum total tokens budget for the entire query context (entities + relations + chunks + system prompt).&quot;&quot;&quot;

    # History mesages is only send to LLM for context, not used for retrieval
    conversation_history: list[dict[str, str]] = field(default_factory=list)
    &quot;&quot;&quot;Stores past conversation history to maintain context.
    Format: [{&quot;role&quot;: &quot;user/assistant&quot;, &quot;content&quot;: &quot;message&quot;}].
    &quot;&quot;&quot;

    ids: list[str] | None = None
    &quot;&quot;&quot;List of ids to filter the results.&quot;&quot;&quot;

    model_func: Callable[..., object] | None = None
    &quot;&quot;&quot;Optional override for the LLM model function to use for this specific query.
    If provided, this will be used instead of the global model function.
    This allows using different models for different query modes.
    &quot;&quot;&quot;

    user_prompt: str | None = None
    &quot;&quot;&quot;User-provided prompt for the query.
    Addition instructions for LLM. If provided, this will be inject into the prompt template.
    It&#39;s purpose is the let user customize the way LLM generate the response.
    &quot;&quot;&quot;

    enable_rerank: bool = True
    &quot;&quot;&quot;Enable reranking for retrieved text chunks. If True but no rerank model is configured, a warning will be issued.
    Default is True to enable reranking when rerank model is available.
    &quot;&quot;&quot;
</code></pre>
<blockquote>
<p>default value of Top_k can be change by environment  variables  TOP_K.</p>
</blockquote>
<h3>LLM and Embedding Injection</h3>
<p>LightRAG requires the utilization of LLM and Embedding models to accomplish document indexing and querying tasks. During the initialization phase, it is necessary to inject the invocation methods of the relevant models into LightRAGÔºö</p>
<details>
<summary> <b>Using Open AI-like APIs</b> </summary>

<ul>
<li>LightRAG also supports Open AI-like chat/embeddings APIs:</li>
</ul>
<pre><code class="language-python">async def llm_model_func(
    prompt, system_prompt=None, history_messages=[], keyword_extraction=False, **kwargs
) -&gt; str:
    return await openai_complete_if_cache(
        &quot;solar-mini&quot;,
        prompt,
        system_prompt=system_prompt,
        history_messages=history_messages,
        api_key=os.getenv(&quot;UPSTAGE_API_KEY&quot;),
        base_url=&quot;https://api.upstage.ai/v1/solar&quot;,
        **kwargs
    )

async def embedding_func(texts: list[str]) -&gt; np.ndarray:
    return await openai_embed(
        texts,
        model=&quot;solar-embedding-1-large-query&quot;,
        api_key=os.getenv(&quot;UPSTAGE_API_KEY&quot;),
        base_url=&quot;https://api.upstage.ai/v1/solar&quot;
    )

async def initialize_rag():
    rag = LightRAG(
        working_dir=WORKING_DIR,
        llm_model_func=llm_model_func,
        embedding_func=EmbeddingFunc(
            embedding_dim=4096,
            func=embedding_func
        )
    )

    await rag.initialize_storages()
    return rag
</code></pre>
</details>

<details>
<summary> <b>Using Hugging Face Models</b> </summary>

<ul>
<li>If you want to use Hugging Face models, you only need to set LightRAG as follows:</li>
</ul>
<p>See <code>lightrag_hf_demo.py</code></p>
<pre><code class="language-python"># Initialize LightRAG with Hugging Face model
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=hf_model_complete,  # Use Hugging Face model for text generation
    llm_model_name=&#39;meta-llama/Llama-3.1-8B-Instruct&#39;,  # Model name from Hugging Face
    # Use Hugging Face embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=384,
        func=lambda texts: hf_embed(
            texts,
            tokenizer=AutoTokenizer.from_pretrained(&quot;sentence-transformers/all-MiniLM-L6-v2&quot;),
            embed_model=AutoModel.from_pretrained(&quot;sentence-transformers/all-MiniLM-L6-v2&quot;)
        )
    ),
)
</code></pre>
</details>

<details>
<summary> <b>Using Ollama Models</b> </summary>
**Overview**

<p>If you want to use Ollama models, you need to pull model you plan to use and embedding model, for example <code>nomic-embed-text</code>.</p>
<p>Then you only need to set LightRAG as follows:</p>
<pre><code class="language-python"># Initialize LightRAG with Ollama model
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=ollama_model_complete,  # Use Ollama model for text generation
    llm_model_name=&#39;your_model_name&#39;, # Your model name
    # Use Ollama embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=768,
        func=lambda texts: ollama_embed(
            texts,
            embed_model=&quot;nomic-embed-text&quot;
        )
    ),
)
</code></pre>
<ul>
<li><strong>Increasing context size</strong></li>
</ul>
<p>In order for LightRAG to work context should be at least 32k tokens. By default Ollama models have context size of 8k. You can achieve this using one of two ways:</p>
<ul>
<li><strong>Increasing the <code>num_ctx</code> parameter in Modelfile</strong></li>
</ul>
<ol>
<li>Pull the model:</li>
</ol>
<pre><code class="language-bash">ollama pull qwen2
</code></pre>
<ol start="2">
<li>Display the model file:</li>
</ol>
<pre><code class="language-bash">ollama show --modelfile qwen2 &gt; Modelfile
</code></pre>
<ol start="3">
<li>Edit the Modelfile by adding the following line:</li>
</ol>
<pre><code class="language-bash">PARAMETER num_ctx 32768
</code></pre>
<ol start="4">
<li>Create the modified model:</li>
</ol>
<pre><code class="language-bash">ollama create -f Modelfile qwen2m
</code></pre>
<ul>
<li><strong>Setup <code>num_ctx</code> via Ollama API</strong></li>
</ul>
<p>Tiy can use <code>llm_model_kwargs</code> param to configure ollama:</p>
<pre><code class="language-python">rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=ollama_model_complete,  # Use Ollama model for text generation
    llm_model_name=&#39;your_model_name&#39;, # Your model name
    llm_model_kwargs={&quot;options&quot;: {&quot;num_ctx&quot;: 32768}},
    # Use Ollama embedding function
    embedding_func=EmbeddingFunc(
        embedding_dim=768,
        func=lambda texts: ollama_embed(
            texts,
            embed_model=&quot;nomic-embed-text&quot;
        )
    ),
)
</code></pre>
<ul>
<li><strong>Low RAM GPUs</strong></li>
</ul>
<p>In order to run this experiment on low RAM GPU you should select small model and tune context window (increasing context increase memory consumption). For example, running this ollama example on repurposed mining GPU with 6Gb of RAM required to set context size to 26k while using <code>gemma2:2b</code>. It was able to find 197 entities and 19 relations on <code>book.txt</code>.</p>
</details>
<details>
<summary> <b>LlamaIndex</b> </summary>

<p>LightRAG supports integration with LlamaIndex (<code>llm/llama_index_impl.py</code>):</p>
<ul>
<li>Integrates with OpenAI and other providers through LlamaIndex</li>
<li>See <a href="lightrag/llm/Readme.md">LlamaIndex Documentation</a> for detailed setup and examples</li>
</ul>
<p><strong>Example Usage</strong></p>
<pre><code class="language-python"># Using LlamaIndex with direct OpenAI access
import asyncio
from lightrag import LightRAG
from lightrag.llm.llama_index_impl import llama_index_complete_if_cache, llama_index_embed
from llama_index.embeddings.openai import OpenAIEmbedding
from llama_index.llms.openai import OpenAI
from lightrag.utils import setup_logger

# Setup log handler for LightRAG
setup_logger(&quot;lightrag&quot;, level=&quot;INFO&quot;)

async def initialize_rag():
    rag = LightRAG(
        working_dir=&quot;your/path&quot;,
        llm_model_func=llama_index_complete_if_cache,  # LlamaIndex-compatible completion function
        embedding_func=EmbeddingFunc(    # LlamaIndex-compatible embedding function
            embedding_dim=1536,
            func=lambda texts: llama_index_embed(texts, embed_model=embed_model)
        ),
    )

    await rag.initialize_storages()
    return rag

def main():
    # Initialize RAG instance
    rag = asyncio.run(initialize_rag())

    with open(&quot;./book.txt&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
        rag.insert(f.read())

    # Perform naive search
    print(
        rag.query(&quot;What are the top themes in this story?&quot;, param=QueryParam(mode=&quot;naive&quot;))
    )

    # Perform local search
    print(
        rag.query(&quot;What are the top themes in this story?&quot;, param=QueryParam(mode=&quot;local&quot;))
    )

    # Perform global search
    print(
        rag.query(&quot;What are the top themes in this story?&quot;, param=QueryParam(mode=&quot;global&quot;))
    )

    # Perform hybrid search
    print(
        rag.query(&quot;What are the top themes in this story?&quot;, param=QueryParam(mode=&quot;hybrid&quot;))
    )

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p><strong>For detailed documentation and examples, see:</strong></p>
<ul>
<li><a href="lightrag/llm/Readme.md">LlamaIndex Documentation</a></li>
<li><a href="examples/lightrag_llamaindex_direct_demo.py">Direct OpenAI Example</a></li>
<li><a href="examples/lightrag_llamaindex_litellm_demo.py">LiteLLM Proxy Example</a></li>
</ul>
</details>

<h3>Rerank Function Injection</h3>
<p>To enhance retrieval quality, documents can be re-ranked based on a more effective relevance scoring model. The <code>rerank.py</code> file provides three Reranker provider driver functions:</p>
<ul>
<li><strong>Cohere / vLLM</strong>: <code>cohere_rerank</code></li>
<li><strong>Jina AI</strong>: <code>jina_rerank</code></li>
<li><strong>Aliyun</strong>: <code>ali_rerank</code></li>
</ul>
<p>You can inject one of these functions into the <code>rerank_model_func</code> attribute of the LightRAG object. This will enable LightRAG&#39;s query function to re-order retrieved text blocks using the injected function. For detailed usage, please refer to the <code>examples/rerank_example.py</code> file.</p>
<h3>User Prompt vs. Query</h3>
<p>When using LightRAG for content queries, avoid combining the search process with unrelated output processing, as this significantly impacts query effectiveness. The <code>user_prompt</code> parameter in Query Param is specifically designed to address this issue ‚Äî it does not participate in the RAG retrieval phase, but rather guides the LLM on how to process the retrieved results after the query is completed. Here&#39;s how to use it:</p>
<pre><code class="language-python"># Create query parameters
query_param = QueryParam(
    mode = &quot;hybrid&quot;,  # Other modesÔºölocal, global, hybrid, mix, naive
    user_prompt = &quot;For diagrams, use mermaid format with English/Pinyin node names and Chinese display labels&quot;,
)

# Query and process
response_default = rag.query(
    &quot;Please draw a character relationship diagram for Scrooge&quot;,
    param=query_param
)
print(response_default)
</code></pre>
<h3>Insert</h3>
<details>
  <summary> <b> Basic Insert </b></summary>

<pre><code class="language-python"># Basic Insert
rag.insert(&quot;Text&quot;)
</code></pre>
</details>

<details>
  <summary> <b> Batch Insert </b></summary>

<pre><code class="language-python"># Basic Batch Insert: Insert multiple texts at once
rag.insert([&quot;TEXT1&quot;, &quot;TEXT2&quot;,...])

# Batch Insert with custom batch size configuration
rag = LightRAG(
    ...
    working_dir=WORKING_DIR,
    max_parallel_insert = 4
)

rag.insert([&quot;TEXT1&quot;, &quot;TEXT2&quot;, &quot;TEXT3&quot;, ...])  # Documents will be processed in batches of 4
</code></pre>
<p>The <code>max_parallel_insert</code> parameter determines the number of documents processed concurrently in the document indexing pipeline. If unspecified, the default value is <strong>2</strong>. We recommend keeping this setting <strong>below 10</strong>, as the performance bottleneck typically lies with the LLM (Large Language Model) processing.The <code>max_parallel_insert</code> parameter determines the number of documents processed concurrently in the document indexing pipeline. If unspecified, the default value is <strong>2</strong>. We recommend keeping this setting <strong>below 10</strong>, as the performance bottleneck typically lies with the LLM (Large Language Model) processing.</p>
</details>

<details>
  <summary> <b> Insert with ID </b></summary>

<p>If you want to provide your own IDs for your documents, number of documents and number of IDs must be the same.</p>
<pre><code class="language-python"># Insert single text, and provide ID for it
rag.insert(&quot;TEXT1&quot;, ids=[&quot;ID_FOR_TEXT1&quot;])

# Insert multiple texts, and provide IDs for them
rag.insert([&quot;TEXT1&quot;, &quot;TEXT2&quot;,...], ids=[&quot;ID_FOR_TEXT1&quot;, &quot;ID_FOR_TEXT2&quot;])
</code></pre>
</details>

<details>
  <summary><b>Insert using Pipeline</b></summary>

<p>The <code>apipeline_enqueue_documents</code> and <code>apipeline_process_enqueue_documents</code> functions allow you to perform incremental insertion of documents into the graph.</p>
<p>This is useful for scenarios where you want to process documents in the background while still allowing the main thread to continue executing.</p>
<p>And using a routine to process new documents.</p>
<pre><code class="language-python">rag = LightRAG(..)

await rag.apipeline_enqueue_documents(input)
# Your routine in loop
await rag.apipeline_process_enqueue_documents(input)
</code></pre>
</details>

<details>
  <summary><b>Insert Multi-file Type Support</b></summary>

<p>The <code>textract</code> supports reading file types such as TXT, DOCX, PPTX, CSV, and PDF.</p>
<pre><code class="language-python">import textract

file_path = &#39;TEXT.pdf&#39;
text_content = textract.process(file_path)

rag.insert(text_content.decode(&#39;utf-8&#39;))
</code></pre>
</details>

<details>
  <summary><b>Citation Functionality</b></summary>

<p>By providing file paths, the system ensures that sources can be traced back to their original documents.</p>
<pre><code class="language-python"># Define documents and their file paths
documents = [&quot;Document content 1&quot;, &quot;Document content 2&quot;]
file_paths = [&quot;path/to/doc1.txt&quot;, &quot;path/to/doc2.txt&quot;]

# Insert documents with file paths
rag.insert(documents, file_paths=file_paths)
</code></pre>
</details>

<h3>Storage</h3>
<p>LightRAG uses 4 types of storage for different purposes:</p>
<ul>
<li>KV_STORAGE: llm response cache, text chunks, document information</li>
<li>VECTOR_STORAGE: entities vectors, relation vectors, chunks vectors</li>
<li>GRAPH_STORAGE: entity relation graph</li>
<li>DOC_STATUS_STORAGE: document indexing status</li>
</ul>
<p>Each storage type has several implementations:</p>
<ul>
<li>KV_STORAGE supported implementations:</li>
</ul>
<pre><code>JsonKVStorage    JsonFile (default)
PGKVStorage      Postgres
RedisKVStorage   Redis
MongoKVStorage   MongoDB
</code></pre>
<ul>
<li>GRAPH_STORAGE supported implementations:</li>
</ul>
<pre><code>NetworkXStorage      NetworkX (default)
Neo4JStorage         Neo4J
PGGraphStorage       PostgreSQL with AGE plugin
MemgraphStorage.     Memgraph
</code></pre>
<blockquote>
<p>Testing has shown that Neo4J delivers superior performance in production environments compared to PostgreSQL with AGE plugin.</p>
</blockquote>
<ul>
<li>VECTOR_STORAGE supported implementations:</li>
</ul>
<pre><code>NanoVectorDBStorage         NanoVector (default)
PGVectorStorage             Postgres
MilvusVectorDBStorage       Milvus
FaissVectorDBStorage        Faiss
QdrantVectorDBStorage       Qdrant
MongoVectorDBStorage        MongoDB
</code></pre>
<ul>
<li>DOC_STATUS_STORAGE: supported implementations:</li>
</ul>
<pre><code>JsonDocStatusStorage        JsonFile (default)
PGDocStatusStorage          Postgres
MongoDocStatusStorage       MongoDB
</code></pre>
<p>Example connection configurations for each storage type can be found in the <code>env.example</code> file. The database instance in the connection string needs to be created by you on the database server beforehand. LightRAG is only responsible for creating tables within the database instance, not for creating the database instance itself. If using Redis as storage, remember to configure automatic data persistence rules for Redis, otherwise data will be lost after the Redis service restarts. If using PostgreSQL, it is recommended to use version 16.6 or above.</p>
<details>
<summary> <b>Using Neo4J Storage</b> </summary>

<ul>
<li>For production level scenarios you will most likely want to leverage an enterprise solution</li>
<li>for KG storage. Running Neo4J in Docker is recommended for seamless local testing.</li>
<li>See: <a href="https://hub.docker.com/_/neo4j">https://hub.docker.com/_/neo4j</a></li>
</ul>
<pre><code class="language-python">export NEO4J_URI=&quot;neo4j://localhost:7687&quot;
export NEO4J_USERNAME=&quot;neo4j&quot;
export NEO4J_PASSWORD=&quot;password&quot;

# Setup logger for LightRAG
setup_logger(&quot;lightrag&quot;, level=&quot;INFO&quot;)

# When you launch the project be sure to override the default KG: NetworkX
# by specifying kg=&quot;Neo4JStorage&quot;.

# Note: Default settings use NetworkX
# Initialize LightRAG with Neo4J implementation.
async def initialize_rag():
    rag = LightRAG(
        working_dir=WORKING_DIR,
        llm_model_func=gpt_4o_mini_complete,  # Use gpt_4o_mini_complete LLM model
        graph_storage=&quot;Neo4JStorage&quot;, #&lt;-----------override KG default
    )

    # Initialize database connections
    await rag.initialize_storages()
    # Initialize pipeline status for document processing
    return rag
</code></pre>
<p>see test_neo4j.py for a working example.</p>
</details>

<details>
<summary> <b>Using PostgreSQL Storage</b> </summary>

<p>For production level scenarios you will most likely want to leverage an enterprise solution. PostgreSQL can provide a one-stop solution for you as KV store, VectorDB (pgvector) and GraphDB (apache AGE). PostgreSQL version 16.6 or higher is supported.</p>
<ul>
<li>PostgreSQL is lightweight,the whole binary distribution including all necessary plugins can be zipped to 40MB: Ref to <a href="https://github.com/ShanGor/apache-age-windows/releases/tag/PG17%2Fv1.5.0-rc0">Windows Release</a> as it is easy to install for Linux/Mac.</li>
<li>If you prefer docker, please start with this image if you are a beginner to avoid hiccups (Default user password:rag/rag): <a href="https://hub.docker.com/r/gzdaniel/postgres-for-rag">https://hub.docker.com/r/gzdaniel/postgres-for-rag</a></li>
<li>How to start? Ref to: <a href="https://github.com/HKUDS/LightRAG/blob/main/examples/lightrag_zhipu_postgres_demo.py">examples/lightrag_zhipu_postgres_demo.py</a></li>
<li>For high-performance graph database requirements, Neo4j is recommended as Apache AGE&#39;s performance is not as competitive.</li>
</ul>
</details>

<details>
<summary> <b>Using Faiss Storage</b> </summary>
Before using Faiss vector database, you must manually install `faiss-cpu` or `faiss-gpu`.

<ul>
<li>Install the required dependencies:</li>
</ul>
<pre><code>pip install faiss-cpu
</code></pre>
<p>You can also install <code>faiss-gpu</code> if you have GPU support.</p>
<ul>
<li>Here we are using <code>sentence-transformers</code> but you can also use <code>OpenAIEmbedding</code> model with <code>3072</code> dimensions.</li>
</ul>
<pre><code class="language-python">async def embedding_func(texts: list[str]) -&gt; np.ndarray:
    model = SentenceTransformer(&#39;all-MiniLM-L6-v2&#39;)
    embeddings = model.encode(texts, convert_to_numpy=True)
    return embeddings

# Initialize LightRAG with the LLM model function and embedding function
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=llm_model_func,
    embedding_func=EmbeddingFunc(
        embedding_dim=384,
        func=embedding_func,
    ),
    vector_storage=&quot;FaissVectorDBStorage&quot;,
    vector_db_storage_cls_kwargs={
        &quot;cosine_better_than_threshold&quot;: 0.3  # Your desired threshold
    }
)
</code></pre>
</details>

<details>
<summary> <b>Using Memgraph for Storage</b> </summary>

<ul>
<li>Memgraph is a high-performance, in-memory graph database compatible with the Neo4j Bolt protocol.</li>
<li>You can run Memgraph locally using Docker for easy testing:</li>
<li>See: <a href="https://memgraph.com/download">https://memgraph.com/download</a></li>
</ul>
<pre><code class="language-python">export MEMGRAPH_URI=&quot;bolt://localhost:7687&quot;

# Setup logger for LightRAG
setup_logger(&quot;lightrag&quot;, level=&quot;INFO&quot;)

# When you launch the project, override the default KG: NetworkX
# by specifying kg=&quot;MemgraphStorage&quot;.

# Note: Default settings use NetworkX
# Initialize LightRAG with Memgraph implementation.
async def initialize_rag():
    rag = LightRAG(
        working_dir=WORKING_DIR,
        llm_model_func=gpt_4o_mini_complete,  # Use gpt_4o_mini_complete LLM model
        graph_storage=&quot;MemgraphStorage&quot;, #&lt;-----------override KG default
    )

    # Initialize database connections
    await rag.initialize_storages()
    # Initialize pipeline status for document processing
    return rag
</code></pre>
</details>

<details>
<summary> <b>Using MongoDB Storage</b> </summary>

<p>MongoDB provides a one-stop storage solution for LightRAG. MongoDB offers native KV storage and vector storage. LightRAG uses MongoDB collections to implement a simple graph storage. MongoDB&#39;s official vector search functionality (<code>$vectorSearch</code>) currently requires their official cloud service MongoDB Atlas. This functionality cannot be used on self-hosted MongoDB Community/Enterprise versions.</p>
</details>

<details>
<summary> <b>Using Redis Storage</b> </summary>

<p>LightRAG supports using Redis as KV storage. When using Redis storage, attention should be paid to persistence configuration and memory usage configuration. The following is the recommended Redis configuration:</p>
<pre><code>save 900 1
save 300 10
save 60 1000
stop-writes-on-bgsave-error yes
maxmemory 4gb
maxmemory-policy noeviction
maxclients 500
</code></pre>
</details>

<h3>Data Isolation Between LightRAG Instances</h3>
<p>The <code>workspace</code> parameter ensures data isolation between different LightRAG instances. Once initialized, the <code>workspace</code> is immutable and cannot be changed.Here is how workspaces are implemented for different types of storage:</p>
<ul>
<li><strong>For local file-based databases, data isolation is achieved through workspace subdirectories:</strong> <code>JsonKVStorage</code>, <code>JsonDocStatusStorage</code>, <code>NetworkXStorage</code>, <code>NanoVectorDBStorage</code>, <code>FaissVectorDBStorage</code>.</li>
<li><strong>For databases that store data in collections, it&#39;s done by adding a workspace prefix to the collection name:</strong> <code>RedisKVStorage</code>, <code>RedisDocStatusStorage</code>, <code>MilvusVectorDBStorage</code>, <code>MongoKVStorage</code>, <code>MongoDocStatusStorage</code>, <code>MongoVectorDBStorage</code>, <code>MongoGraphStorage</code>, <code>PGGraphStorage</code>.</li>
<li><strong>For Qdrant vector database, data isolation is achieved through payload-based partitioning (Qdrant&#39;s recommended multitenancy approach):</strong> <code>QdrantVectorDBStorage</code> uses shared collections with payload filtering for unlimited workspace scalability.</li>
<li><strong>For relational databases, data isolation is achieved by adding a <code>workspace</code> field to the tables for logical data separation:</strong> <code>PGKVStorage</code>, <code>PGVectorStorage</code>, <code>PGDocStatusStorage</code>.</li>
<li><strong>For the Neo4j graph database, logical data isolation is achieved through labels:</strong> <code>Neo4JStorage</code></li>
</ul>
<p>To maintain compatibility with legacy data, the default workspace for PostgreSQL non-graph storage is <code>default</code> and, for PostgreSQL AGE graph storage is null, for Neo4j graph storage is <code>base</code> when no workspace is configured. For all external storages, the system provides dedicated workspace environment variables to override the common <code>WORKSPACE</code> environment variable configuration. These storage-specific workspace environment variables are: <code>REDIS_WORKSPACE</code>, <code>MILVUS_WORKSPACE</code>, <code>QDRANT_WORKSPACE</code>, <code>MONGODB_WORKSPACE</code>, <code>POSTGRES_WORKSPACE</code>, <code>NEO4J_WORKSPACE</code>.</p>
<h3>AGENTS.md -- Guiding Coding Agents</h3>
<p>AGENTS.md is a simple, open format for guiding coding agents (<a href="https://agents.md/">https://agents.md/</a>). It is a dedicated, predictable place to provide the context and instructions to help AI coding agents work on LightRAG project. Different AI coders should not maintain separate guidance files individually. If any AI coder cannot automatically recognize AGENTS.md, symbolic links can be used as a solution. After establishing symbolic links, you can prevent them from being committed to the Git repository by configuring your local <code>.gitignore_global</code>.</p>
<h2>Edit Entities and Relations</h2>
<p>LightRAG now supports comprehensive knowledge graph management capabilities, allowing you to create, edit, and delete entities and relationships within your knowledge graph.</p>
<details>
  <summary> <b> Create Entities and Relations </b></summary>

<pre><code class="language-python"># Create new entity
entity = rag.create_entity(&quot;Google&quot;, {
    &quot;description&quot;: &quot;Google is a multinational technology company specializing in internet-related services and products.&quot;,
    &quot;entity_type&quot;: &quot;company&quot;
})

# Create another entity
product = rag.create_entity(&quot;Gmail&quot;, {
    &quot;description&quot;: &quot;Gmail is an email service developed by Google.&quot;,
    &quot;entity_type&quot;: &quot;product&quot;
})

# Create relation between entities
relation = rag.create_relation(&quot;Google&quot;, &quot;Gmail&quot;, {
    &quot;description&quot;: &quot;Google develops and operates Gmail.&quot;,
    &quot;keywords&quot;: &quot;develops operates service&quot;,
    &quot;weight&quot;: 2.0
})
</code></pre>
</details>

<details>
  <summary> <b> Edit Entities and Relations </b></summary>

<pre><code class="language-python"># Edit an existing entity
updated_entity = rag.edit_entity(&quot;Google&quot;, {
    &quot;description&quot;: &quot;Google is a subsidiary of Alphabet Inc., founded in 1998.&quot;,
    &quot;entity_type&quot;: &quot;tech_company&quot;
})

# Rename an entity (with all its relationships properly migrated)
renamed_entity = rag.edit_entity(&quot;Gmail&quot;, {
    &quot;entity_name&quot;: &quot;Google Mail&quot;,
    &quot;description&quot;: &quot;Google Mail (formerly Gmail) is an email service.&quot;
})

# Edit a relation between entities
updated_relation = rag.edit_relation(&quot;Google&quot;, &quot;Google Mail&quot;, {
    &quot;description&quot;: &quot;Google created and maintains Google Mail service.&quot;,
    &quot;keywords&quot;: &quot;creates maintains email service&quot;,
    &quot;weight&quot;: 3.0
})
</code></pre>
<p>All operations are available in both synchronous and asynchronous versions. The asynchronous versions have the prefix &quot;a&quot; (e.g., <code>acreate_entity</code>, <code>aedit_relation</code>).</p>
</details>

<details>
  <summary> <b> Insert Custom KG </b></summary>

<pre><code class="language-python">custom_kg = {
        &quot;chunks&quot;: [
            {
                &quot;content&quot;: &quot;Alice and Bob are collaborating on quantum computing research.&quot;,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;,
            }
        ],
        &quot;entities&quot;: [
            {
                &quot;entity_name&quot;: &quot;Alice&quot;,
                &quot;entity_type&quot;: &quot;person&quot;,
                &quot;description&quot;: &quot;Alice is a researcher specializing in quantum physics.&quot;,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            },
            {
                &quot;entity_name&quot;: &quot;Bob&quot;,
                &quot;entity_type&quot;: &quot;person&quot;,
                &quot;description&quot;: &quot;Bob is a mathematician.&quot;,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            },
            {
                &quot;entity_name&quot;: &quot;Quantum Computing&quot;,
                &quot;entity_type&quot;: &quot;technology&quot;,
                &quot;description&quot;: &quot;Quantum computing utilizes quantum mechanical phenomena for computation.&quot;,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            }
        ],
        &quot;relationships&quot;: [
            {
                &quot;src_id&quot;: &quot;Alice&quot;,
                &quot;tgt_id&quot;: &quot;Bob&quot;,
                &quot;description&quot;: &quot;Alice and Bob are research partners.&quot;,
                &quot;keywords&quot;: &quot;collaboration research&quot;,
                &quot;weight&quot;: 1.0,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            },
            {
                &quot;src_id&quot;: &quot;Alice&quot;,
                &quot;tgt_id&quot;: &quot;Quantum Computing&quot;,
                &quot;description&quot;: &quot;Alice conducts research on quantum computing.&quot;,
                &quot;keywords&quot;: &quot;research expertise&quot;,
                &quot;weight&quot;: 1.0,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            },
            {
                &quot;src_id&quot;: &quot;Bob&quot;,
                &quot;tgt_id&quot;: &quot;Quantum Computing&quot;,
                &quot;description&quot;: &quot;Bob researches quantum computing.&quot;,
                &quot;keywords&quot;: &quot;research application&quot;,
                &quot;weight&quot;: 1.0,
                &quot;source_id&quot;: &quot;doc-1&quot;,
                &quot;file_path&quot;: &quot;test_file&quot;
            }
        ]
    }

rag.insert_custom_kg(custom_kg)
</code></pre>
</details>

<details>
  <summary> <b>Other Entity and Relation Operations</b></summary>

<ul>
<li><p><strong>create_entity</strong>: Creates a new entity with specified attributes</p>
</li>
<li><p><strong>edit_entity</strong>: Updates an existing entity&#39;s attributes or renames it</p>
</li>
<li><p><strong>create_relation</strong>: Creates a new relation between existing entities</p>
</li>
<li><p><strong>edit_relation</strong>: Updates an existing relation&#39;s attributes</p>
</li>
</ul>
<p>These operations maintain data consistency across both the graph database and vector database components, ensuring your knowledge graph remains coherent.</p>
</details>

<h2>Delete Functions</h2>
<p>LightRAG provides comprehensive deletion capabilities, allowing you to delete documents, entities, and relationships.</p>
<details>
<summary> <b>Delete Entities</b> </summary>

<p>You can delete entities by their name along with all associated relationships:</p>
<pre><code class="language-python"># Delete entity and all its relationships (synchronous version)
rag.delete_by_entity(&quot;Google&quot;)

# Asynchronous version
await rag.adelete_by_entity(&quot;Google&quot;)
</code></pre>
<p>When deleting an entity:</p>
<ul>
<li>Removes the entity node from the knowledge graph</li>
<li>Deletes all associated relationships</li>
<li>Removes related embedding vectors from the vector database</li>
<li>Maintains knowledge graph integrity</li>
</ul>
</details>

<details>
<summary> <b>Delete Relations</b> </summary>

<p>You can delete relationships between two specific entities:</p>
<pre><code class="language-python"># Delete relationship between two entities (synchronous version)
rag.delete_by_relation(&quot;Google&quot;, &quot;Gmail&quot;)

# Asynchronous version
await rag.adelete_by_relation(&quot;Google&quot;, &quot;Gmail&quot;)
</code></pre>
<p>When deleting a relationship:</p>
<ul>
<li>Removes the specified relationship edge</li>
<li>Deletes the relationship&#39;s embedding vector from the vector database</li>
<li>Preserves both entity nodes and their other relationships</li>
</ul>
</details>

<details>
<summary> <b>Delete by Document ID</b> </summary>

<p>You can delete an entire document and all its related knowledge through document ID:</p>
<pre><code class="language-python"># Delete by document ID (asynchronous version)
await rag.adelete_by_doc_id(&quot;doc-12345&quot;)
</code></pre>
<p>Optimized processing when deleting by document ID:</p>
<ul>
<li><strong>Smart Cleanup</strong>: Automatically identifies and removes entities and relationships that belong only to this document</li>
<li><strong>Preserve Shared Knowledge</strong>: If entities or relationships exist in other documents, they are preserved and their descriptions are rebuilt</li>
<li><strong>Cache Optimization</strong>: Clears related LLM cache to reduce storage overhead</li>
<li><strong>Incremental Rebuilding</strong>: Reconstructs affected entity and relationship descriptions from remaining documents</li>
</ul>
<p>The deletion process includes:</p>
<ol>
<li>Delete all text chunks related to the document</li>
<li>Identify and delete entities and relationships that belong only to this document</li>
<li>Rebuild entities and relationships that still exist in other documents</li>
<li>Update all related vector indexes</li>
<li>Clean up document status records</li>
</ol>
<p>Note: Deletion by document ID is an asynchronous operation as it involves complex knowledge graph reconstruction processes.</p>
</details>

<p><strong>Important Reminders:</strong></p>
<ol>
<li><strong>Irreversible Operations</strong>: All deletion operations are irreversible, please use with caution</li>
<li><strong>Performance Considerations</strong>: Deleting large amounts of data may take some time, especially deletion by document ID</li>
<li><strong>Data Consistency</strong>: Deletion operations automatically maintain consistency between the knowledge graph and vector database</li>
<li><strong>Backup Recommendations</strong>: Consider backing up data before performing important deletion operations</li>
</ol>
<p><strong>Batch Deletion Recommendations:</strong></p>
<ul>
<li>For batch deletion operations, consider using asynchronous methods for better performance</li>
<li>For large-scale deletions, consider processing in batches to avoid excessive system load</li>
</ul>
<h2>Entity Merging</h2>
<details>
<summary> <b>Merge Entities and Their Relationships</b> </summary>

<p>LightRAG now supports merging multiple entities into a single entity, automatically handling all relationships:</p>
<pre><code class="language-python"># Basic entity merging
rag.merge_entities(
    source_entities=[&quot;Artificial Intelligence&quot;, &quot;AI&quot;, &quot;Machine Intelligence&quot;],
    target_entity=&quot;AI Technology&quot;
)
</code></pre>
<p>With custom merge strategy:</p>
<pre><code class="language-python"># Define custom merge strategy for different fields
rag.merge_entities(
    source_entities=[&quot;John Smith&quot;, &quot;Dr. Smith&quot;, &quot;J. Smith&quot;],
    target_entity=&quot;John Smith&quot;,
    merge_strategy={
        &quot;description&quot;: &quot;concatenate&quot;,  # Combine all descriptions
        &quot;entity_type&quot;: &quot;keep_first&quot;,   # Keep the entity type from the first entity
        &quot;source_id&quot;: &quot;join_unique&quot;     # Combine all unique source IDs
    }
)
</code></pre>
<p>With custom target entity data:</p>
<pre><code class="language-python"># Specify exact values for the merged entity
rag.merge_entities(
    source_entities=[&quot;New York&quot;, &quot;NYC&quot;, &quot;Big Apple&quot;],
    target_entity=&quot;New York City&quot;,
    target_entity_data={
        &quot;entity_type&quot;: &quot;LOCATION&quot;,
        &quot;description&quot;: &quot;New York City is the most populous city in the United States.&quot;,
    }
)
</code></pre>
<p>Advanced usage combining both approaches:</p>
<pre><code class="language-python"># Merge company entities with both strategy and custom data
rag.merge_entities(
    source_entities=[&quot;Microsoft Corp&quot;, &quot;Microsoft Corporation&quot;, &quot;MSFT&quot;],
    target_entity=&quot;Microsoft&quot;,
    merge_strategy={
        &quot;description&quot;: &quot;concatenate&quot;,  # Combine all descriptions
        &quot;source_id&quot;: &quot;join_unique&quot;     # Combine source IDs
    },
    target_entity_data={
        &quot;entity_type&quot;: &quot;ORGANIZATION&quot;,
    }
)
</code></pre>
<p>When merging entities:</p>
<ul>
<li>All relationships from source entities are redirected to the target entity</li>
<li>Duplicate relationships are intelligently merged</li>
<li>Self-relationships (loops) are prevented</li>
<li>Source entities are removed after merging</li>
<li>Relationship weights and attributes are preserved</li>
</ul>
</details>

<h2>Multimodal Document Processing (RAG-Anything Integration)</h2>
<p>LightRAG now seamlessly integrates with <a href="https://github.com/HKUDS/RAG-Anything">RAG-Anything</a>, a comprehensive <strong>All-in-One Multimodal Document Processing RAG system</strong> built specifically for LightRAG. RAG-Anything enables advanced parsing and retrieval-augmented generation (RAG) capabilities, allowing you to handle multimodal documents seamlessly and extract structured content‚Äîincluding text, images, tables, and formulas‚Äîfrom various document formats for integration into your RAG pipeline.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>End-to-End Multimodal Pipeline</strong>: Complete workflow from document ingestion and parsing to intelligent multimodal query answering</li>
<li><strong>Universal Document Support</strong>: Seamless processing of PDFs, Office documents (DOC/DOCX/PPT/PPTX/XLS/XLSX), images, and diverse file formats</li>
<li><strong>Specialized Content Analysis</strong>: Dedicated processors for images, tables, mathematical equations, and heterogeneous content types</li>
<li><strong>Multimodal Knowledge Graph</strong>: Automatic entity extraction and cross-modal relationship discovery for enhanced understanding</li>
<li><strong>Hybrid Intelligent Retrieval</strong>: Advanced search capabilities spanning textual and multimodal content with contextual understanding</li>
</ul>
<p><strong>Quick Start:</strong></p>
<ol>
<li>Install RAG-Anything:<pre><code class="language-bash">pip install raganything
</code></pre>
</li>
<li>Process multimodal documents: <details>
 <summary> <b> RAGAnything Usage Example </b></summary>

<pre><code class="language-python">    import asyncio
    from raganything import RAGAnything
    from lightrag import LightRAG
    from lightrag.llm.openai import openai_complete_if_cache, openai_embed
    from lightrag.utils import EmbeddingFunc
    import os

    async def load_existing_lightrag():
        # First, create or load an existing LightRAG instance
        lightrag_working_dir = &quot;./existing_lightrag_storage&quot;

        # Check if previous LightRAG instance exists
        if os.path.exists(lightrag_working_dir) and os.listdir(lightrag_working_dir):
            print(&quot;‚úÖ Found existing LightRAG instance, loading...&quot;)
        else:
            print(&quot;‚ùå No existing LightRAG instance found, will create new one&quot;)

        # Create/Load LightRAG instance with your configurations
        lightrag_instance = LightRAG(
            working_dir=lightrag_working_dir,
            llm_model_func=lambda prompt, system_prompt=None, history_messages=[], **kwargs: openai_complete_if_cache(
                &quot;gpt-4o-mini&quot;,
                prompt,
                system_prompt=system_prompt,
                history_messages=history_messages,
                api_key=&quot;your-api-key&quot;,
                **kwargs,
            ),
            embedding_func=EmbeddingFunc(
                embedding_dim=3072,
                func=lambda texts: openai_embed(
                    texts,
                    model=&quot;text-embedding-3-large&quot;,
                    api_key=api_key,
                    base_url=base_url,
                ),
            )
        )

        # Initialize storage (this will load existing data if available)
        await lightrag_instance.initialize_storages()

        # Now initialize RAGAnything with the existing LightRAG instance
        rag = RAGAnything(
            lightrag=lightrag_instance,  # Pass the existing LightRAG instance
            # Only need vision model for multimodal processing
            vision_model_func=lambda prompt, system_prompt=None, history_messages=[], image_data=None, **kwargs: openai_complete_if_cache(
                &quot;gpt-4o&quot;,
                &quot;&quot;,
                system_prompt=None,
                history_messages=[],
                messages=[
                    {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: system_prompt} if system_prompt else None,
                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: [
                        {&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: prompt},
                        {&quot;type&quot;: &quot;image_url&quot;, &quot;image_url&quot;: {&quot;url&quot;: f&quot;data:image/jpeg;base64,{image_data}&quot;}}
                    ]} if image_data else {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt}
                ],
                api_key=&quot;your-api-key&quot;,
                **kwargs,
            ) if image_data else openai_complete_if_cache(
                &quot;gpt-4o-mini&quot;,
                prompt,
                system_prompt=system_prompt,
                history_messages=history_messages,
                api_key=&quot;your-api-key&quot;,
                **kwargs,
            )
            # Note: working_dir, llm_model_func, embedding_func, etc. are inherited from lightrag_instance
        )

        # Query the existing knowledge base
        result = await rag.query_with_multimodal(
            &quot;What data has been processed in this LightRAG instance?&quot;,
            mode=&quot;hybrid&quot;
        )
        print(&quot;Query result:&quot;, result)

        # Add new multimodal documents to the existing LightRAG instance
        await rag.process_document_complete(
            file_path=&quot;path/to/new/multimodal_document.pdf&quot;,
            output_dir=&quot;./output&quot;
        )

    if __name__ == &quot;__main__&quot;:
        asyncio.run(load_existing_lightrag())
</code></pre>
 </details></li>
</ol>
<p>For detailed documentation and advanced usage, please refer to the <a href="https://github.com/HKUDS/RAG-Anything">RAG-Anything repository</a>.</p>
<h2>Token Usage Tracking</h2>
<details>
<summary> <b>Overview and Usage</b> </summary>

<p>LightRAG provides a TokenTracker tool to monitor and manage token consumption by large language models. This feature is particularly useful for controlling API costs and optimizing performance.</p>
<h3>Usage</h3>
<pre><code class="language-python">from lightrag.utils import TokenTracker

# Create TokenTracker instance
token_tracker = TokenTracker()

# Method 1: Using context manager (Recommended)
# Suitable for scenarios requiring automatic token usage tracking
with token_tracker:
    result1 = await llm_model_func(&quot;your question 1&quot;)
    result2 = await llm_model_func(&quot;your question 2&quot;)

# Method 2: Manually adding token usage records
# Suitable for scenarios requiring more granular control over token statistics
token_tracker.reset()

rag.insert()

rag.query(&quot;your question 1&quot;, param=QueryParam(mode=&quot;naive&quot;))
rag.query(&quot;your question 2&quot;, param=QueryParam(mode=&quot;mix&quot;))

# Display total token usage (including insert and query operations)
print(&quot;Token usage:&quot;, token_tracker.get_usage())
</code></pre>
<h3>Usage Tips</h3>
<ul>
<li>Use context managers for long sessions or batch operations to automatically track all token consumption</li>
<li>For scenarios requiring segmented statistics, use manual mode and call reset() when appropriate</li>
<li>Regular checking of token usage helps detect abnormal consumption early</li>
<li>Actively use this feature during development and testing to optimize production costs</li>
</ul>
<h3>Practical Examples</h3>
<p>You can refer to these examples for implementing token tracking:</p>
<ul>
<li><code>examples/lightrag_gemini_track_token_demo.py</code>: Token tracking example using Google Gemini model</li>
<li><code>examples/lightrag_siliconcloud_track_token_demo.py</code>: Token tracking example using SiliconCloud model</li>
</ul>
<p>These examples demonstrate how to effectively use the TokenTracker feature with different models and scenarios.</p>
</details>

<h2>Data Export Functions</h2>
<h3>Overview</h3>
<p>LightRAG allows you to export your knowledge graph data in various formats for analysis, sharing, and backup purposes. The system supports exporting entities, relations, and relationship data.</p>
<h3>Export Functions</h3>
<details>
  <summary> <b> Basic Usage </b></summary>

<pre><code class="language-python"># Basic CSV export (default format)
rag.export_data(&quot;knowledge_graph.csv&quot;)

# Specify any format
rag.export_data(&quot;output.xlsx&quot;, file_format=&quot;excel&quot;)
</code></pre>
</details>

<details>
  <summary> <b> Different File Formats supported </b></summary>

<pre><code class="language-python">#Export data in CSV format
rag.export_data(&quot;graph_data.csv&quot;, file_format=&quot;csv&quot;)

# Export data in Excel sheet
rag.export_data(&quot;graph_data.xlsx&quot;, file_format=&quot;excel&quot;)

# Export data in markdown format
rag.export_data(&quot;graph_data.md&quot;, file_format=&quot;md&quot;)

# Export data in Text
rag.export_data(&quot;graph_data.txt&quot;, file_format=&quot;txt&quot;)
</code></pre>
</details>

<details>
  <summary> <b> Additional Options </b></summary>

<p>Include vector embeddings in the export (optional):</p>
<pre><code class="language-python">rag.export_data(&quot;complete_data.csv&quot;, include_vector_data=True)
</code></pre>
</details>

<h3>Data Included in Export</h3>
<p>All exports include:</p>
<ul>
<li>Entity information (names, IDs, metadata)</li>
<li>Relation data (connections between entities)</li>
<li>Relationship information from vector database</li>
</ul>
<h2>Cache</h2>
<details>
  <summary> <b>Clear Cache</b> </summary>

<p>You can clear the LLM response cache with different modes:</p>
<pre><code class="language-python"># Clear all cache
await rag.aclear_cache()

# Clear local mode cache
await rag.aclear_cache(modes=[&quot;local&quot;])

# Clear extraction cache
await rag.aclear_cache(modes=[&quot;default&quot;])

# Clear multiple modes
await rag.aclear_cache(modes=[&quot;local&quot;, &quot;global&quot;, &quot;hybrid&quot;])

# Synchronous version
rag.clear_cache(modes=[&quot;local&quot;])
</code></pre>
<p>Valid modes are:</p>
<ul>
<li><code>&quot;default&quot;</code>: Extraction cache</li>
<li><code>&quot;naive&quot;</code>: Naive search cache</li>
<li><code>&quot;local&quot;</code>: Local search cache</li>
<li><code>&quot;global&quot;</code>: Global search cache</li>
<li><code>&quot;hybrid&quot;</code>: Hybrid search cache</li>
<li><code>&quot;mix&quot;</code>: Mix search cache</li>
</ul>
</details>

<h2>Troubleshooting</h2>
<h3>Common Initialization Errors</h3>
<p>If you encounter these errors when using LightRAG:</p>
<ol>
<li><p><strong><code>AttributeError: __aenter__</code></strong></p>
<ul>
<li><strong>Cause</strong>: Storage backends not initialized</li>
<li><strong>Solution</strong>: Call <code>await rag.initialize_storages()</code> after creating the LightRAG instance</li>
</ul>
</li>
<li><p><strong><code>KeyError: &#39;history_messages&#39;</code></strong></p>
<ul>
<li><strong>Cause</strong>: Pipeline status not initialized</li>
<li><strong>Solution</strong>: Call `</li>
</ul>
</li>
<li><p><strong>Both errors in sequence</strong></p>
<ul>
<li><strong>Cause</strong>: Neither initialization method was called</li>
<li><strong>Solution</strong>: Always follow this pattern:</li>
</ul>
<pre><code class="language-python">rag = LightRAG(...)
await rag.initialize_storages()   ```
</code></pre>
</li>
</ol>
<h3>Model Switching Issues</h3>
<p>When switching between different embedding models, you must clear the data directory to avoid errors. The only file you may want to preserve is <code>kv_store_llm_response_cache.json</code> if you wish to retain the LLM cache.</p>
<h2>LightRAG API</h2>
<p>The LightRAG Server is designed to provide Web UI and API support.  <strong>For more information about LightRAG Server, please refer to <a href="./lightrag/api/README.md">LightRAG Server</a>.</strong></p>
<h2>Graph Visualization</h2>
<p>The LightRAG Server offers a comprehensive knowledge graph visualization feature. It supports various gravity layouts, node queries, subgraph filtering, and more. <strong>For more information about LightRAG Server, please refer to <a href="./lightrag/api/README.md">LightRAG Server</a>.</strong></p>
<p><img src="./README.assets/iShot_2025-03-23_12.40.08.png" alt="iShot_2025-03-23_12.40.08"></p>
<h2>Langfuse observability integration</h2>
<p>Langfuse provides a drop-in replacement for the OpenAI client that automatically tracks all LLM interactions, enabling developers to monitor, debug, and optimize their RAG systems without code changes.</p>
<h3>Installation with Langfuse option</h3>
<pre><code>pip install lightrag-hku
pip install lightrag-hku[observability]

# Or install from souce code with debug mode enabled
pip install -e .
pip install -e &quot;.[observability]&quot;
</code></pre>
<h3>Config Langfuse env vars</h3>
<p>modify .env file:</p>
<pre><code>## Langfuse Observability (Optional)
# LLM observability and tracing platform
# Install with: pip install lightrag-hku[observability]
# Sign up at: https://cloud.langfuse.com or self-host
LANGFUSE_SECRET_KEY=&quot;&quot;
LANGFUSE_PUBLIC_KEY=&quot;&quot;
LANGFUSE_HOST=&quot;https://cloud.langfuse.com&quot;  # or your self-hosted instance
LANGFUSE_ENABLE_TRACE=true
</code></pre>
<h3>Langfuse Usage</h3>
<p>Once installed and configured, Langfuse automatically traces all OpenAI LLM calls. Langfuse dashboard features include:</p>
<ul>
<li><strong>Tracing</strong>: View complete LLM call chains</li>
<li><strong>Analytics</strong>: Token usage, latency, cost metrics</li>
<li><strong>Debugging</strong>: Inspect prompts and responses</li>
<li><strong>Evaluation</strong>: Compare model outputs</li>
<li><strong>Monitoring</strong>: Real-time alerting</li>
</ul>
<h3>Important Notice</h3>
<p><strong>Note</strong>: LightRAG currently only integrates OpenAI-compatible API calls with Langfuse. APIs such as Ollama, Azure, and AWS Bedrock are not yet supported for Langfuse observability.</p>
<h2>RAGAS-based Evaluation</h2>
<p><strong>RAGAS</strong> (Retrieval Augmented Generation Assessment) is a framework for reference-free evaluation of RAG systems using LLMs. There is an evaluation script based on RAGAS. For detailed information, please refer to <a href="lightrag/evaluation/README.md">RAGAS-based Evaluation Framework</a>.</p>
<h2>Evaluation</h2>
<h3>Dataset</h3>
<p>The dataset used in LightRAG can be downloaded from <a href="https://huggingface.co/datasets/TommyChien/UltraDomain">TommyChien/UltraDomain</a>.</p>
<h3>Generate Query</h3>
<p>LightRAG uses the following prompt to generate high-level queries, with the corresponding code in <code>examples/generate_query.py</code>.</p>
<details>
<summary> Prompt </summary>

<pre><code class="language-python">Given the following description of a dataset:

{description}

Please identify 5 potential users who would engage with this dataset. For each user, list 5 tasks they would perform with this dataset. Then, for each (user, task) combination, generate 5 questions that require a high-level understanding of the entire dataset.

Output the results in the following structure:
- User 1: [user description]
    - Task 1: [task description]
        - Question 1:
        - Question 2:
        - Question 3:
        - Question 4:
        - Question 5:
    - Task 2: [task description]
        ...
    - Task 5: [task description]
- User 2: [user description]
    ...
- User 5: [user description]
    ...
</code></pre>
</details>

<h3>Batch Eval</h3>
<p>To evaluate the performance of two RAG systems on high-level queries, LightRAG uses the following prompt, with the specific code available in <code>reproduce/batch_eval.py</code>.</p>
<details>
<summary> Prompt </summary>

<pre><code class="language-python">---Role---
You are an expert tasked with evaluating two answers to the same question based on three criteria: **Comprehensiveness**, **Diversity**, and **Empowerment**.
---Goal---
You will evaluate two answers to the same question based on three criteria: **Comprehensiveness**, **Diversity**, and **Empowerment**.

- **Comprehensiveness**: How much detail does the answer provide to cover all aspects and details of the question?
- **Diversity**: How varied and rich is the answer in providing different perspectives and insights on the question?
- **Empowerment**: How well does the answer help the reader understand and make informed judgments about the topic?

For each criterion, choose the better answer (either Answer 1 or Answer 2) and explain why. Then, select an overall winner based on these three categories.

Here is the question:
{query}

Here are the two answers:

**Answer 1:**
{answer1}

**Answer 2:**
{answer2}

Evaluate both answers using the three criteria listed above and provide detailed explanations for each criterion.

Output your evaluation in the following JSON format:

{{
    &quot;Comprehensiveness&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Provide explanation here]&quot;
    }},
    &quot;Empowerment&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Provide explanation here]&quot;
    }},
    &quot;Overall Winner&quot;: {{
        &quot;Winner&quot;: &quot;[Answer 1 or Answer 2]&quot;,
        &quot;Explanation&quot;: &quot;[Summarize why this answer is the overall winner based on the three criteria]&quot;
    }}
}}
</code></pre>
</details>

<h3>Overall Performance Table</h3>
<table>
<thead>
<tr>
<th></th>
<th><strong>Agriculture</strong></th>
<th></th>
<th><strong>CS</strong></th>
<th></th>
<th><strong>Legal</strong></th>
<th></th>
<th><strong>Mix</strong></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>NaiveRAG</td>
<td><strong>LightRAG</strong></td>
<td>NaiveRAG</td>
<td><strong>LightRAG</strong></td>
<td>NaiveRAG</td>
<td><strong>LightRAG</strong></td>
<td>NaiveRAG</td>
<td><strong>LightRAG</strong></td>
</tr>
<tr>
<td><strong>Comprehensiveness</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
<td>38.4%</td>
<td><strong>61.6%</strong></td>
<td>16.4%</td>
<td><strong>83.6%</strong></td>
<td>38.8%</td>
<td><strong>61.2%</strong></td>
</tr>
<tr>
<td><strong>Diversity</strong></td>
<td>23.6%</td>
<td><strong>76.4%</strong></td>
<td>38.0%</td>
<td><strong>62.0%</strong></td>
<td>13.6%</td>
<td><strong>86.4%</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
</tr>
<tr>
<td><strong>Empowerment</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
<td>38.8%</td>
<td><strong>61.2%</strong></td>
<td>16.4%</td>
<td><strong>83.6%</strong></td>
<td>42.8%</td>
<td><strong>57.2%</strong></td>
</tr>
<tr>
<td><strong>Overall</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
<td>38.8%</td>
<td><strong>61.2%</strong></td>
<td>15.2%</td>
<td><strong>84.8%</strong></td>
<td>40.0%</td>
<td><strong>60.0%</strong></td>
</tr>
<tr>
<td></td>
<td>RQ-RAG</td>
<td><strong>LightRAG</strong></td>
<td>RQ-RAG</td>
<td><strong>LightRAG</strong></td>
<td>RQ-RAG</td>
<td><strong>LightRAG</strong></td>
<td>RQ-RAG</td>
<td><strong>LightRAG</strong></td>
</tr>
<tr>
<td><strong>Comprehensiveness</strong></td>
<td>31.6%</td>
<td><strong>68.4%</strong></td>
<td>38.8%</td>
<td><strong>61.2%</strong></td>
<td>15.2%</td>
<td><strong>84.8%</strong></td>
<td>39.2%</td>
<td><strong>60.8%</strong></td>
</tr>
<tr>
<td><strong>Diversity</strong></td>
<td>29.2%</td>
<td><strong>70.8%</strong></td>
<td>39.2%</td>
<td><strong>60.8%</strong></td>
<td>11.6%</td>
<td><strong>88.4%</strong></td>
<td>30.8%</td>
<td><strong>69.2%</strong></td>
</tr>
<tr>
<td><strong>Empowerment</strong></td>
<td>31.6%</td>
<td><strong>68.4%</strong></td>
<td>36.4%</td>
<td><strong>63.6%</strong></td>
<td>15.2%</td>
<td><strong>84.8%</strong></td>
<td>42.4%</td>
<td><strong>57.6%</strong></td>
</tr>
<tr>
<td><strong>Overall</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
<td>38.0%</td>
<td><strong>62.0%</strong></td>
<td>14.4%</td>
<td><strong>85.6%</strong></td>
<td>40.0%</td>
<td><strong>60.0%</strong></td>
</tr>
<tr>
<td></td>
<td>HyDE</td>
<td><strong>LightRAG</strong></td>
<td>HyDE</td>
<td><strong>LightRAG</strong></td>
<td>HyDE</td>
<td><strong>LightRAG</strong></td>
<td>HyDE</td>
<td><strong>LightRAG</strong></td>
</tr>
<tr>
<td><strong>Comprehensiveness</strong></td>
<td>26.0%</td>
<td><strong>74.0%</strong></td>
<td>41.6%</td>
<td><strong>58.4%</strong></td>
<td>26.8%</td>
<td><strong>73.2%</strong></td>
<td>40.4%</td>
<td><strong>59.6%</strong></td>
</tr>
<tr>
<td><strong>Diversity</strong></td>
<td>24.0%</td>
<td><strong>76.0%</strong></td>
<td>38.8%</td>
<td><strong>61.2%</strong></td>
<td>20.0%</td>
<td><strong>80.0%</strong></td>
<td>32.4%</td>
<td><strong>67.6%</strong></td>
</tr>
<tr>
<td><strong>Empowerment</strong></td>
<td>25.2%</td>
<td><strong>74.8%</strong></td>
<td>40.8%</td>
<td><strong>59.2%</strong></td>
<td>26.0%</td>
<td><strong>74.0%</strong></td>
<td>46.0%</td>
<td><strong>54.0%</strong></td>
</tr>
<tr>
<td><strong>Overall</strong></td>
<td>24.8%</td>
<td><strong>75.2%</strong></td>
<td>41.6%</td>
<td><strong>58.4%</strong></td>
<td>26.4%</td>
<td><strong>73.6%</strong></td>
<td>42.4%</td>
<td><strong>57.6%</strong></td>
</tr>
<tr>
<td></td>
<td>GraphRAG</td>
<td><strong>LightRAG</strong></td>
<td>GraphRAG</td>
<td><strong>LightRAG</strong></td>
<td>GraphRAG</td>
<td><strong>LightRAG</strong></td>
<td>GraphRAG</td>
<td><strong>LightRAG</strong></td>
</tr>
<tr>
<td><strong>Comprehensiveness</strong></td>
<td>45.6%</td>
<td><strong>54.4%</strong></td>
<td>48.4%</td>
<td><strong>51.6%</strong></td>
<td>48.4%</td>
<td><strong>51.6%</strong></td>
<td><strong>50.4%</strong></td>
<td>49.6%</td>
</tr>
<tr>
<td><strong>Diversity</strong></td>
<td>22.8%</td>
<td><strong>77.2%</strong></td>
<td>40.8%</td>
<td><strong>59.2%</strong></td>
<td>26.4%</td>
<td><strong>73.6%</strong></td>
<td>36.0%</td>
<td><strong>64.0%</strong></td>
</tr>
<tr>
<td><strong>Empowerment</strong></td>
<td>41.2%</td>
<td><strong>58.8%</strong></td>
<td>45.2%</td>
<td><strong>54.8%</strong></td>
<td>43.6%</td>
<td><strong>56.4%</strong></td>
<td><strong>50.8%</strong></td>
<td>49.2%</td>
</tr>
<tr>
<td><strong>Overall</strong></td>
<td>45.2%</td>
<td><strong>54.8%</strong></td>
<td>48.0%</td>
<td><strong>52.0%</strong></td>
<td>47.2%</td>
<td><strong>52.8%</strong></td>
<td><strong>50.4%</strong></td>
<td>49.6%</td>
</tr>
</tbody></table>
<h2>Reproduce</h2>
<p>All the code can be found in the <code>./reproduce</code> directory.</p>
<h3>Step-0 Extract Unique Contexts</h3>
<p>First, we need to extract unique contexts in the datasets.</p>
<details>
<summary> Code </summary>

<pre><code class="language-python">def extract_unique_contexts(input_directory, output_directory):

    os.makedirs(output_directory, exist_ok=True)

    jsonl_files = glob.glob(os.path.join(input_directory, &#39;*.jsonl&#39;))
    print(f&quot;Found {len(jsonl_files)} JSONL files.&quot;)

    for file_path in jsonl_files:
        filename = os.path.basename(file_path)
        name, ext = os.path.splitext(filename)
        output_filename = f&quot;{name}_unique_contexts.json&quot;
        output_path = os.path.join(output_directory, output_filename)

        unique_contexts_dict = {}

        print(f&quot;Processing file: {filename}&quot;)

        try:
            with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as infile:
                for line_number, line in enumerate(infile, start=1):
                    line = line.strip()
                    if not line:
                        continue
                    try:
                        json_obj = json.loads(line)
                        context = json_obj.get(&#39;context&#39;)
                        if context and context not in unique_contexts_dict:
                            unique_contexts_dict[context] = None
                    except json.JSONDecodeError as e:
                        print(f&quot;JSON decoding error in file {filename} at line {line_number}: {e}&quot;)
        except FileNotFoundError:
            print(f&quot;File not found: {filename}&quot;)
            continue
        except Exception as e:
            print(f&quot;An error occurred while processing file {filename}: {e}&quot;)
            continue

        unique_contexts_list = list(unique_contexts_dict.keys())
        print(f&quot;There are {len(unique_contexts_list)} unique `context` entries in the file {filename}.&quot;)

        try:
            with open(output_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as outfile:
                json.dump(unique_contexts_list, outfile, ensure_ascii=False, indent=4)
            print(f&quot;Unique `context` entries have been saved to: {output_filename}&quot;)
        except Exception as e:
            print(f&quot;An error occurred while saving to the file {output_filename}: {e}&quot;)

    print(&quot;All files have been processed.&quot;)
</code></pre>
</details>

<h3>Step-1 Insert Contexts</h3>
<p>For the extracted contexts, we insert them into the LightRAG system.</p>
<details>
<summary> Code </summary>

<pre><code class="language-python">def insert_text(rag, file_path):
    with open(file_path, mode=&#39;r&#39;) as f:
        unique_contexts = json.load(f)

    retries = 0
    max_retries = 3
    while retries &lt; max_retries:
        try:
            rag.insert(unique_contexts)
            break
        except Exception as e:
            retries += 1
            print(f&quot;Insertion failed, retrying ({retries}/{max_retries}), error: {e}&quot;)
            time.sleep(10)
    if retries == max_retries:
        print(&quot;Insertion failed after exceeding the maximum number of retries&quot;)
</code></pre>
</details>

<h3>Step-2 Generate Queries</h3>
<p>We extract tokens from the first and the second half of each context in the dataset, then combine them as dataset descriptions to generate queries.</p>
<details>
<summary> Code </summary>

<pre><code class="language-python">tokenizer = GPT2Tokenizer.from_pretrained(&#39;gpt2&#39;)

def get_summary(context, tot_tokens=2000):
    tokens = tokenizer.tokenize(context)
    half_tokens = tot_tokens // 2

    start_tokens = tokens[1000:1000 + half_tokens]
    end_tokens = tokens[-(1000 + half_tokens):1000]

    summary_tokens = start_tokens + end_tokens
    summary = tokenizer.convert_tokens_to_string(summary_tokens)

    return summary
</code></pre>
</details>

<h3>Step-3 Query</h3>
<p>For the queries generated in Step-2, we will extract them and query LightRAG.</p>
<details>
<summary> Code </summary>

<pre><code class="language-python">def extract_queries(file_path):
    with open(file_path, &#39;r&#39;) as f:
        data = f.read()

    data = data.replace(&#39;**&#39;, &#39;&#39;)

    queries = re.findall(r&#39;- Question \d+: (.+)&#39;, data)

    return queries
</code></pre>
</details>

<h2>üîó Related Projects</h2>
<p><em>Ecosystem &amp; Extensions</em></p>
<div align="center">
  <table>
    <tr>
      <td align="center">
        <a href="https://github.com/HKUDS/RAG-Anything">
          <div style="width: 100px; height: 100px; background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(0, 217, 255, 0.05) 100%); border-radius: 15px; border: 1px solid rgba(0, 217, 255, 0.2); display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <span style="font-size: 32px;">üì∏</span>
          </div>
          <b>RAG-Anything</b><br>
          <sub>Multimodal RAG</sub>
        </a>
      </td>
      <td align="center">
        <a href="https://github.com/HKUDS/VideoRAG">
          <div style="width: 100px; height: 100px; background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(0, 217, 255, 0.05) 100%); border-radius: 15px; border: 1px solid rgba(0, 217, 255, 0.2); display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <span style="font-size: 32px;">üé•</span>
          </div>
          <b>VideoRAG</b><br>
          <sub>Extreme Long-Context Video RAG</sub>
        </a>
      </td>
      <td align="center">
        <a href="https://github.com/HKUDS/MiniRAG">
          <div style="width: 100px; height: 100px; background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(0, 217, 255, 0.05) 100%); border-radius: 15px; border: 1px solid rgba(0, 217, 255, 0.2); display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <span style="font-size: 32px;">‚ú®</span>
          </div>
          <b>MiniRAG</b><br>
          <sub>Extremely Simple RAG</sub>
        </a>
      </td>
    </tr>
  </table>
</div>

<hr>
<h2>‚≠ê Star History</h2>
<a href="https://star-history.com/#HKUDS/LightRAG&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=HKUDS/LightRAG&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=HKUDS/LightRAG&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=HKUDS/LightRAG&type=Date" />
 </picture>
</a>

<h2>ü§ù Contribution</h2>
<div align="center">
  We thank all our contributors for their valuable contributions.
</div>

<div align="center">
  <a href="https://github.com/HKUDS/LightRAG/graphs/contributors">
    <img src="https://contrib.rocks/image?repo=HKUDS/LightRAG" style="border-radius: 15px; box-shadow: 0 0 20px rgba(0, 217, 255, 0.3);" />
  </a>
</div>

<hr>
<h2>üìñ Citation</h2>
<pre><code class="language-python">@article{guo2024lightrag,
title={LightRAG: Simple and Fast Retrieval-Augmented Generation},
author={Zirui Guo and Lianghao Xia and Yanhua Yu and Tu Ao and Chao Huang},
year={2024},
eprint={2410.05779},
archivePrefix={arXiv},
primaryClass={cs.IR}
}
</code></pre>
<hr>
<div align="center" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 30px; margin: 30px 0;">
  <div>
    <img src="https://user-images.githubusercontent.com/74038190/212284100-561aa473-3905-4a80-b561-0d28506553ee.gif" width="500">
  </div>
  <div style="margin-top: 20px;">
    <a href="https://github.com/HKUDS/LightRAG" style="text-decoration: none;">
      <img src="https://img.shields.io/badge/‚≠ê%20Star%20us%20on%20GitHub-1a1a2e?style=for-the-badge&logo=github&logoColor=white">
    </a>
    <a href="https://github.com/HKUDS/LightRAG/issues" style="text-decoration: none;">
      <img src="https://img.shields.io/badge/üêõ%20Report%20Issues-ff6b6b?style=for-the-badge&logo=github&logoColor=white">
    </a>
    <a href="https://github.com/HKUDS/LightRAG/discussions" style="text-decoration: none;">
      <img src="https://img.shields.io/badge/üí¨%20Discussions-4ecdc4?style=for-the-badge&logo=github&logoColor=white">
    </a>
  </div>
</div>

<div align="center">
  <div style="width: 100%; max-width: 600px; margin: 20px auto; padding: 20px; background: linear-gradient(135deg, rgba(0, 217, 255, 0.1) 0%, rgba(0, 217, 255, 0.05) 100%); border-radius: 15px; border: 1px solid rgba(0, 217, 255, 0.2);">
    <div style="display: flex; justify-content: center; align-items: center; gap: 15px;">
      <span style="font-size: 24px;">‚≠ê</span>
      <span style="color: #00d9ff; font-size: 18px;">Thank you for visiting LightRAG!</span>
      <span style="font-size: 24px;">‚≠ê</span>
    </div>
  </div>
</div>
 </div> </article>  <section class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"> <h2 class="text-3xl font-bold text-center mb-8">Related Models</h2> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"> <a href="/model/github-langgenius-dify" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full"> <div class="absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full animate-pulse" title="Rising Star">
üî•
</div> <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="dify"> dify </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by langgenius</p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> Production-ready platform for agentic workflow development....
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="238,804 likes">‚ù§Ô∏è <span>238.8K</span></div> <div class="flex items-center gap-1" title="238,804 downloads">üì• <span>238.8K</span></div> </div> </div> </a><a href="/model/github-microsoft-graphrag" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full"> <div class="absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full animate-pulse" title="Rising Star">
üî•
</div> <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="graphrag"> graphrag </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by microsoft</p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> A modular graph-based Retrieval-Augmented Generation (RAG) system...
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="58,536 likes">‚ù§Ô∏è <span>58.5K</span></div> <div class="flex items-center gap-1" title="58,536 downloads">üì• <span>58.5K</span></div> </div> </div> </a><a href="/model/github-deepset-ai-haystack" class="group relative block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 overflow-hidden h-full"> <div class="absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full animate-pulse" title="Rising Star">
üî•
</div> <div class="p-5 flex flex-col h-full justify-between"> <div> <h3 class="text-lg font-bold text-gray-900 dark:text-white truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors" title="haystack"> haystack </h3> <p class="text-gray-500 dark:text-gray-400 text-xs mb-3">by deepset-ai</p> <p class="text-gray-600 dark:text-gray-300 text-sm h-20 overflow-hidden text-ellipsis leading-relaxed"> AI orchestration framework to build customizable, production-ready LLM applications. Connect components (models, vector ...
</p> </div> <div class="mt-4 flex items-center justify-end gap-4 text-xs text-gray-500 dark:text-gray-400"> <div class="flex items-center gap-1" title="46,874 likes">‚ù§Ô∏è <span>46.9K</span></div> <div class="flex items-center gap-1" title="46,874 downloads">üì• <span>46.9K</span></div> </div> </div> </a> </div> </section> </main> <footer class="bg-gray-800 text-gray-300 py-8 mt-16"> <div class="container mx-auto px-4 text-center"> <div class="flex justify-center gap-4 mb-4"> <a href="/about" class="hover:underline">About</a> <a href="/compliance" class="hover:underline">Compliance</a> </div> <p class="text-sm mt-2">
&copy; 2025 Free AI Tools. An open-source project to index the world of AI.
</p> <a href="mailto:compliance@free2aitools.com" class="text-sm text-gray-400 hover:underline mt-1 block">compliance@free2aitools.com</a> </div> </footer> </body></html>