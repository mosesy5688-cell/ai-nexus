<!DOCTYPE html><html lang="en"> <head><!-- Google Tag Manager --><script type="module">(function(e,n,r,t,m){e[t]=e[t]||[],e[t].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var g=n.getElementsByTagName(r)[0],a=n.createElement(r),s="";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+m+s,g.parentNode.insertBefore(a,g)})(window,document,"script","dataLayer","GTM-58C2CQ8G");</script><!-- End Google Tag Manager --><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><!-- Open Graph Meta Tags --><meta property="og:type" content="website"><meta property="og:url" content="https://free2aitools.com/model/github-Kwai-Kolors-CoTyle/"><meta property="og:title" content="CoTyle - AI Model Details"><meta property="og:description" content="<p align=&#34;center&#34;>      <a href=&#34;https://arxiv.org/abs/2511.10555&#34;><img alt=&#34;Build&#34; src=&#34;https://img.shields.io/badge/arXiv-Paper-da282a.svg&#34;></a>..."><meta property="og:image" content="https://free2aitools.com/og-image.jpg"><!-- Twitter Card Meta Tags --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://free2aitools.com/model/github-Kwai-Kolors-CoTyle/"><meta property="twitter:title" content="CoTyle - AI Model Details"><meta property="twitter:description" content="<p align=&#34;center&#34;>      <a href=&#34;https://arxiv.org/abs/2511.10555&#34;><img alt=&#34;Build&#34; src=&#34;https://img.shields.io/badge/arXiv-Paper-da282a.svg&#34;></a>..."><meta property="twitter:image" content="https://free2aitools.com/og-image.jpg"><meta name="description" content="<p align=&#34;center&#34;>      <a href=&#34;https://arxiv.org/abs/2511.10555&#34;><img alt=&#34;Build&#34; src=&#34;https://img.shields.io/badge/arXiv-Paper-da282a.svg&#34;></a>..."><title>CoTyle - AI Model Details</title><link rel="canonical" href="https://free2aitools.com/model/github-Kwai-Kolors-CoTyle/"><!-- Google AdSense --><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2292826803755214" crossorigin="anonymous"></script><link rel="stylesheet" href="/_astro/about.C4wyk6Sp.css"></head> <body class="bg-gray-50 text-gray-800 font-sans antialiased flex flex-col min-h-screen"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-58C2CQ8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <header class="sticky top-0 z-30 w-full backdrop-blur flex-none transition-colors duration-500 lg:border-b lg:border-gray-200 bg-white/80"> <nav class="container mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex items-center justify-between h-16"> <!-- Site Logo --> <a href="/" class="flex items-center gap-2 text-xl sm:text-2xl font-bold text-gray-900"> <span>Free AI Tools</span> </a> <!-- Right-side items --> <div class="flex items-center gap-4"> <!-- Desktop Navigation --> <div class="hidden md:flex items-center gap-6"> <a href="/" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Explore Models </a><a href="/ranking" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Rankings </a><a href="/reports" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> Reports </a><a href="/about" class="text-base font-medium text-gray-600 hover:text-blue-600 transition-colors"> About </a> </div> <!-- Mobile Search & Menu Toggle --> <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-default" aria-expanded="false"> <span class="sr-only">Open main menu</span> <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path></svg> </button> </div> </div> <!-- Mobile Collapsible Menu --> <div class="hidden w-full md:hidden" id="navbar-default"> <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50"> <li> <a href="/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Explore Models</a> </li><li> <a href="/ranking" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Rankings</a> </li><li> <a href="/reports" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">Reports</a> </li><li> <a href="/about" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0">About</a> </li> </ul> </div> </nav> </header> <main class="flex-grow">  <div class="container mx-auto px-4 py-12"> <div class="max-w-4xl mx-auto"> <!-- Header Section --> <header class="mb-8"> <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4"> <div> <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-2">CoTyle</h1> <p class="text-lg text-gray-500 dark:text-gray-400">by Kwai-Kolors</p> </div>  </div> </header> <!-- Metadata Section --> <div class="mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg"> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center"> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Likes</p> <p class="text-xl font-bold">73</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Downloads</p> <p class="text-xl font-bold">73</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Task</p> <p class="text-xl font-bold capitalize">tool</p> </div> <div> <p class="text-sm text-gray-500 dark:text-gray-400">Last Updated</p> <p class="text-xl font-bold">2025/11/20</p> </div> </div> </div> <!-- Tags and Sources --> <div class="mb-8 flex flex-wrap items-start gap-4"> <div class="flex-1"> <h3 class="text-lg font-semibold mb-2">Tags</h3> <div class="flex flex-wrap gap-2">  </div> </div> <div class="flex-shrink-0"> <h3 class="text-lg font-semibold mb-2">Sources</h3> <div class="flex flex-col gap-2"> <a href="https://github.com/Kwai-Kolors/CoTyle" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-2"> üì¶ GitHub </a> </div> </div> </div> <!-- Source Specific Details --> <div class="mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"> <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"> üì¶ GitHub Details
</h3> <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"> <div><strong>Language:</strong> Python</div> <div><strong>Stars:</strong> 73</div> <div><strong>Forks:</strong> 2</div> <div><strong>Open Issues:</strong> 3</div> <div><strong>License:</strong> Apache License 2.0</div>  </div>  </div> <!-- README Content --> <article class="model-readme-content py-8 border-t border-gray-200 dark:border-gray-700"> <div class="prose prose-lg dark:prose-invert max-w-none"> <h1>üé® A Style is Worth One Code: Unlocking Code-to-Style Image Generation with Discrete Style Space</h1>
<p align="center"> 
    <a href="https://arxiv.org/abs/2511.10555"><img alt="Build" src="https://img.shields.io/badge/arXiv-Paper-da282a.svg"></a>
    <a href="https://Kwai-Kolors.github.io/CoTyle/"><img alt="Build" src="https://img.shields.io/badge/Project%20Page-Homepage-yellow"></a> 
    <a href="https://github.com/Kwai-Kolors/CoTyle"><img alt="Build" src="https://img.shields.io/badge/GitHub-Code-f8f0f0.svg"></a> 
    <a href="https://huggingface.co/spaces/Kwai-Kolors/CoTyle"><img src="https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Demo-32CD32"></a>
    <a href="https://huggingface.co/Kwai-Kolors/CoTyle"><img src="https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Model-fd8b02"></a>
</p>

<p align="center">
    <span style="color:#137cf3; font-family: Gill Sans">Huijie Liu</span><sup>1,2</sup>,
    <span style="color:#137cf3; font-family: Gill Sans">Shuhao Cui</span><sup>2</sup>,
    <span style="color:#137cf3; font-family: Gill Sans">Haoxiang Cao</span><sup>2,3</sup>,
    <span style="color:#137cf3; font-family: Gill Sans">Shuai Ma</span><sup>1</sup>,
    <span style="color:#137cf3; font-family: Gill Sans">Kai Wu</span><sup>2,‚Ä†</sup>,
    <span style="color:#137cf3; font-family: Gill Sans">Guoliang Kang</span><sup>1,‚Ä†</sup>
    <br>
    <sup>1</sup><span style="font-size: 16px">Beihang University</span>,
    <sup>2</sup><span style="font-size: 16px">Kolors Team, Kuaishou Technology</span>, 
    <sup>3</sup><span style="font-size: 16px">South China Normal University</span>
    <br>
    <sup>‚Ä†</sup><span style="font-size: 16px">Co-Corresponding Author</span>
</p>

<blockquote>
<p>This repository offers the official code of the paper <em>&quot;A Style is Worth One Code: Unlocking Code-to-Style Image Generation with Discrete Style Space&quot;</em>. We provide both an Open-Source Version (based on Qwen-Image) and a Commercial Version (based on Kolors). If you are a professional developer and interested in further developing the CoTyle Open-Source Version, please follow the tutorial below. The Commercial Version is coming soon.</p>
</blockquote>
<p align="center">
<img src="assets/2-fig1_01.png" width=95% height=95% 
class="center">
</p>


<h2>üî• News</h2>
<ul>
<li>[11/18/2025] The <a href="https://huggingface.co/spaces/Kwai-Kolors/CoTyle">demo</a> of CoTyle is released on Hugging Face.</li>
<li>[11/18/2025] The <a href="https://huggingface.co/Kwai-Kolors/CoTyle">weights</a> of CoTyle are released on Hugging Face.</li>
<li>[11/18/2025] The <a href="https://github.com/Kwai-Kolors/CoTyle">code</a> is released!</li>
<li>[11/18/2025] The <a href="https://Kwai-Kolors.github.io/CoTyle/">homepage</a> of CoTyle is released.</li>
<li>[11/14/2025] The <a href="https://arxiv.org/abs/2511.10555">paper</a> of CoTyle is released.</li>
</ul>
<h2>üìù ToDo</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> Publish the paper on Arxiv.</li>
<li><input checked="" disabled="" type="checkbox"> Release the homepage of CoTyle.</li>
<li><input checked="" disabled="" type="checkbox"> Launch a free demo on Hugging Face Spaces of CoTyle.</li>
<li><input checked="" disabled="" type="checkbox"> Open source the code and model weights of CoTyle.</li>
<li><input disabled="" type="checkbox"> Release the commercial version of CoTyle.</li>
</ul>
<h2>üìñ Abstract</h2>
<p>Innovative visual stylization is a cornerstone of artistic creation, yet generating novel and consistent visual styles remains a significant challenge. Existing generative approaches typically rely on lengthy textual prompts, reference images, or parameter-efficient fine-tuning to guide style-aware image synthesis, but often struggle with style consistency, limited novelty, and complex style representations. In this paper, we affirm that a style is worth one numerical code by introducing the novel task, code-to-style image generation, which produces images with novel, consistent visual styles conditioned solely on a numerical style code. To date, this field has only been primarily explored by the industry (e.g., Midjourney), with no open-source research from the academic community. To fill this gap,
we propose CoTyle, the first open-source method for this task. Specifically, we first train a discrete style codebook from a collection of images to extract style embeddings. These embeddings are used to condition a text-to-image diffusion model (T2I-DM) for style-consistent generation. Subsequently, we train an autoregressive transformer on the quantized style codes to model their distribution, allowing the synthesis of novel style codes. During inference, a numerical code maps to a unique style sequence,
which guides the diffusion process to produce images in the corresponding style. Unlike existing methods, our approach offers unparalleled simplicity and diversity, unlocking a vast space of reproducible styles from minimal input. Extensive experiments validate that CoTyle effectively turns a numerical code into a style controller, demonstrating a style is worth one code.</p>
<h2>‚ö°Ô∏è Quick Start</h2>
<h3>üîß Requirements and Installation</h3>
<p>Run the following command to install the requirements.</p>
<pre><code class="language-bash">git clone https://github.com/Kwai-Kolors/CoTyle
cd CoTyle
conda create -n cotyle python=3.10 
conda activate cotyle
pip install torch==2.6.0 torchvision==0.21.0
pip install -e git+https://github.com/Lakonik/piFlow.git@b1ef16e5e305251bccdfeac2a0e3d0ef339b974a#egg=lakonlab --no-build-isolation
pip install -r requirements.txt
# After running, some dependency errors may appear (don‚Äôt meet lakonlab‚Äôs requirements). 
# This is normal and can be ignored.
</code></pre>
<h3>‚è¨ Download</h3>
<p>Please download the checkpoints and put them to the <code>./pretrained_models</code> directory.
You can download them from <a href="https://huggingface.co/Kwai-Kolors/CoTyle/tree/main">Hugging Face</a>.</p>
<pre><code class="language-bash">git lfs install
git clone https://huggingface.co/Kwai-Kolors/CoTyle
mv CoTyle pretrained_models
</code></pre>
<h3>üöÑ Code-to-Style Generation</h3>
<p>For a quick walkthrough of the inference pipeline, we recommend generating a single image (see Single-Sample Generation).
To intuitively experience the powerful capabilities of CoTyle, we recommend generating a batch of images (see Batch-Sample Generation), which by default produces 42 images (7 style codes √ó 6 prompts).</p>
<h4>Batch-Samples Generation</h4>
<p>Run the following command to generate a batch of images. By default, 7 rows and 6 columns of images will be generated, where all images in each row are produced using the same style code, and all images in each column are generated using the same prompt. 
You can adjust the <code>--style_code</code> and the content in <code>./test_prompts.txt</code> to obtain the desired outputs.</p>
<p>This process may take considerable time. 
Therefore, we provide an accelerated version based on <a href="https://github.com/Lakonik/piFlow">piFlow</a>, which requires only 4 denoising steps; however, this approach produces lower image quality.
Enable <code>--accelerate</code> to activate piFlow.</p>
<pre><code class="language-bash">python inference_batch.py --model_path ./pretrained_models \
  --style_code 1234567 5201314 13415926 886 20010627 996007 2333 \
  --prompt_file_path ./test_prompts.txt \
  --output_path outputs \
  --seed 1024 \
  --accelerate
</code></pre>
<p>If time permits, we strongly recommend executing the command below.</p>
<pre><code class="language-bash">python inference_batch.py --model_path ./pretrained_models \
  --style_code 1234567 5201314 13415926 886 20010627 996007 2333 \
  --prompt_file_path ./test_prompts.txt \
  --output_path outputs \
  --seed 1024 \
</code></pre>
<p>After successful execution, you will obtain the following results:</p>
<p align="center">
<img src="assets/batch_example.png" width=95% height=95% 
class="center">
</p>


<h4>Single-Sample Generation</h4>
<p>Execute the following code for single-sample inference. You can generate desired results by adjusting the <code>--style_code</code> and <code>--prompt</code>.</p>
<pre><code class="language-bash">python inference.py --model_path ./pretrained_models \
  --style_code 1234567 \
  --prompt &quot;A lovely crystal snake spirit, slender and nimble, wears an exquisite crystal crown atop its head. Its scales are translucent, shimmering like crystal, its eyes are bright and round, and its expression is lively. Its body coils naturally, its tail gracefully curved, its overall posture harmonious and beautiful.&quot; \
  --output_path outputs \
  --seed 1024
</code></pre>
<p>Similarly, you can enable the <code>--accelerate</code> to speed up.</p>
<h2>üì≤ Gradio Apps</h2>
<p>We provide Gradio apps for interactivate inference with the CoTyle.</p>
<p>Official apps are available on <a href="https://huggingface.co/spaces/Kwai-Kolors/CoTyle">HuggingFace Spaces</a>.</p>
<p>If you want to run it locally, please execute:</p>
<pre><code class="language-bash">python app.py
</code></pre>
<p><strong>Note</strong>: The Gradio apps use an accelerated version, which may result in a slight reduction in image generation quality.</p>
<p><strong>Tips</strong>:</p>
<ul>
<li>Adjust the <strong>Number of Prompts</strong> slider to add or remove input rows.</li>
<li>Type your own prompts directly in the text boxes.</li>
<li>You can click any template below to quickly load preset style code and prompts.<p align="center">
<img src="assets/demo.png" width=95% height=95% 
class="center">
</p></li>
</ul>
<h2>üåü Citation</h2>
<p>If CoTyle is helpful, please help to ‚≠ê the repo.</p>
<p>If you find this project useful for your research, please consider citing our paper:</p>
<pre><code class="language-bibtex">@misc{liu2025styleworthcodeunlocking,
      title={A Style is Worth One Code: Unlocking Code-to-Style Image Generation with Discrete Style Space}, 
      author={Huijie Liu and Shuhao Cui and Haoxiang Cao and Shuai Ma and Kai Wu and Guoliang Kang},
      year={2025},
      eprint={2511.10555},
      archivePrefix={arXiv},
      primaryClass={cs.CV},
      url={https://arxiv.org/abs/2511.10555}, 
}
</code></pre>
<h2>üíå Acknowledge</h2>
<p>This code builds on <a href="https://huggingface.co/docs/diffusers/index">diffusers</a>, <a href="https://github.com/QwenLM/Qwen-Image">Qwen-Image</a>, <a href="https://github.com/Lakonik/piFlow">piFlow</a> and <a href="https://github.com/FoundationVision/UniTok">UniTok</a>. Thanks for open-sourcing!</p>
 </div> </article> <!-- Related Models Section -->  </div> </div>  </main> <footer class="bg-gray-800 text-gray-300 py-8 mt-16"> <div class="container mx-auto px-4 text-center"> <div class="flex justify-center gap-4 mb-4"> <a href="/about" class="hover:underline">About</a> <a href="/compliance" class="hover:underline">Compliance</a> </div> <p class="text-sm mt-2">
&copy; 2025 Free AI Tools. An open-source project to index the world of AI.
</p> <a href="mailto:compliance@free2aitools.com" class="text-sm text-gray-400 hover:underline mt-1 block">compliance@free2aitools.com</a> </div> </footer> </body></html>